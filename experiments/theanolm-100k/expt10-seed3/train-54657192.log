EXPT_NAME theanolm-100k
EXPT_PARAMS expt10-seed3
EXPT_WORK_DIR /scratch/work/moisioa3/conv_lm/experiments/theanolm-100k/expt10-seed3
Experiment: theanolm-100k/expt10-seed3
Job ID: 54657192
Task ID: 
Host: gpu26.int.triton.aalto.fi
Start date: Thu Jul  9 08:38:04 EEST 2020
Work directory: /scratch/work/moisioa3/conv_lm/experiments/theanolm-100k/expt10-seed3
Temporary directory: /tmp/54657192

Currently Loaded Modules:
  1) anaconda3/latest   2) cuda/10.0.130   3) cudnn/7.4.2-cuda

 

floatX=float32,device=cuda0,base_compiledir=/tmp/theano,exception_verbosity=high,openmp=False
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
/scratch/work/groszt1/envs/theanoLM/lib/python3.7/site-packages/theano/gpuarray/dnn.py:184: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version >= v5 and <= v7.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7402 on context None
Mapped name None to device cuda0: Tesla P100-PCIE-16GB (0000:82:00.0)
TheanoLM 1.3.2
Theano 1.0.4
pygpu 0.7.6
==
+ srun --gres=gpu:1 theanolm train /scratch/work/moisioa3/conv_lm/experiments/theanolm-100k/expt10-seed3/nnlm.h5 --training-set /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt --validation-file /scratch/work/moisioa3/conv_lm/data/devel/plain.txt --sequence-length 25 --batch-size 24 --optimization-method adagrad --stopping-criterion annealing-count --cost nce --learning-rate 1 --gradient-decay-rate 0.9 --numerical-stability-term 1e-6 --num-noise-samples 500 --noise-dampening 0.5 --noise-sharing batch --validation-frequency 5 --patience 2 --max-epochs 50 --min-epochs 1 --random-seed 2 --log-level debug --log-interval 1000 --gradient-normalization 5 --architecture /scratch/work/moisioa3/conv_lm/configs/word+proj500+lstm1500+htanh1500x4+dropout0.2+softmax.arch --sampling 1 0.2 --vocabulary /scratch/work/moisioa3/conv_lm/models/100k.vocab --vocabulary-format words
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
2020-07-09 08:40:49,624 _read_vocabulary: Reading vocabulary from /scratch/work/moisioa3/conv_lm/models/100k.vocab.
2020-07-09 08:41:33,167 _read_vocabulary: Computing unigram probabilities for out-of-shortlist words.
2020-07-09 08:41:34,501 compute_probs: Out-of-shortlist word log probabilities are in the range [-18.353268, -14.952070].
2020-07-09 08:41:35,729 _read_vocabulary: Number of words in vocabulary: 2427252
2020-07-09 08:41:35,729 _read_vocabulary: Number of words in shortlist: 100003
2020-07-09 08:41:35,729 _read_vocabulary: Number of word classes: 100003
2020-07-09 08:41:35,759 log_options: Training options:
2020-07-09 08:41:35,759 log_options:   batch_size: 24
2020-07-09 08:41:35,759 log_options:   max_annealing_count: 0
2020-07-09 08:41:35,759 log_options:   max_epochs: 50
2020-07-09 08:41:35,760 log_options:   min_epochs: 1
2020-07-09 08:41:35,760 log_options:   patience: 2
2020-07-09 08:41:35,760 log_options:   sequence_length: 25
2020-07-09 08:41:35,760 log_options:   stopping_criterion: annealing-count
2020-07-09 08:41:35,760 log_options:   validation_frequency: 5
2020-07-09 08:41:35,760 log_options: Optimization options:
2020-07-09 08:41:35,760 log_options:   epsilon=1e-06
2020-07-09 08:41:35,760 log_options:   gradient_decay_rate=0.9
2020-07-09 08:41:35,761 log_options:   learning_rate=1.0
2020-07-09 08:41:35,761 log_options:   max_gradient_norm=5.0
2020-07-09 08:41:35,761 log_options:   method=adagrad
2020-07-09 08:41:35,761 log_options:   momentum=0.9
2020-07-09 08:41:35,761 log_options:   noise_sharing=batch
2020-07-09 08:41:35,761 log_options:   num_noise_samples=500
2020-07-09 08:41:35,761 log_options:   sqr_gradient_decay_rate=0.999
2020-07-09 08:41:35,762 log_options:   weights=[1. 1.]
2020-07-09 08:41:35,762 log_options:   cost_function=nce
2020-07-09 08:41:35,762 log_options:   noise_distribution=uniform
2020-07-09 08:41:35,762 log_options:   noise_dampening=0
2020-07-09 08:41:35,762 log_options:   noise_sharing=batch
2020-07-09 08:41:35,762 log_options:   exclude_unk=no
2020-07-09 08:41:35,763 log_options:   l1_regularization=0.000000
2020-07-09 08:41:35,763 log_options:   l2_regularization=0.000000
2020-07-09 08:41:35,763 log_options: Data sampling: [1.  0.2]
2020-07-09 08:41:35,763 train: Creating trainer.
Computing the number of mini-batches in training data.
2020-07-09 08:45:11,696 __init__: One epoch of training data contains 379639 mini-batch updates.
2020-07-09 08:45:11,705 __init__: Class unigram log probabilities are in the range [-inf, -2.305218].
2020-07-09 08:45:11,705 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt.
2020-07-09 08:45:11,709 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt.
2020-07-09 08:45:16,961 _reset: Generating a random order of input lines.
2020-07-09 08:45:18,046 train: Building neural network.
2020-07-09 08:45:18,057 get_default_device: Context None device="Tesla P100-PCIE-16GB" ID="0000:82:00.0"
2020-07-09 08:45:18,140 __init__: Creating layers.
2020-07-09 08:45:18,140 __init__: - NetworkInput name=word_input inputs=[] size=100003 activation=tanh devices=[]
2020-07-09 08:45:18,140 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=500 activation=tanh devices=[None]
2020-07-09 08:45:21,287 add:      * layers/projection_layer/W size=50001500 type=float32 device=None
2020-07-09 08:45:21,299 __init__: - DropoutLayer name=dropout_layer_1 inputs=[projection_layer] size=500 activation=tanh devices=[None]
2020-07-09 08:45:21,299 __init__:   dropout_rate=0.200000
2020-07-09 08:45:21,300 __init__: - LSTMLayer name=hidden_layer_1 inputs=[dropout_layer_1] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:25,181 add:      * layers/hidden_layer_1/layer_input/W size=3000000 type=float32 device=None
2020-07-09 08:45:35,870 add:      * layers/hidden_layer_1/step_input/W size=9000000 type=float32 device=None
2020-07-09 08:45:35,871 add:      * layers/hidden_layer_1/layer_input/b size=6000 type=float32 device=None
2020-07-09 08:45:35,871 __init__: - DropoutLayer name=dropout_layer_2 inputs=[hidden_layer_1] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:35,871 __init__:   dropout_rate=0.200000
2020-07-09 08:45:35,871 __init__: - HighwayLayer name=hidden_layer_2 inputs=[dropout_layer_2] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:41,313 add:      * layers/hidden_layer_2/input/W size=4500000 type=float32 device=None
2020-07-09 08:45:41,314 add:      * layers/hidden_layer_2/input/b size=3000 type=float32 device=None
2020-07-09 08:45:41,314 __init__: - DropoutLayer name=dropout_layer_3 inputs=[hidden_layer_2] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:41,314 __init__:   dropout_rate=0.200000
2020-07-09 08:45:41,314 __init__: - HighwayLayer name=hidden_layer_3 inputs=[dropout_layer_3] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:46,739 add:      * layers/hidden_layer_3/input/W size=4500000 type=float32 device=None
2020-07-09 08:45:46,739 add:      * layers/hidden_layer_3/input/b size=3000 type=float32 device=None
2020-07-09 08:45:46,739 __init__: - DropoutLayer name=dropout_layer_4 inputs=[hidden_layer_3] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:46,739 __init__:   dropout_rate=0.200000
2020-07-09 08:45:46,740 __init__: - HighwayLayer name=hidden_layer_4 inputs=[dropout_layer_4] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:52,194 add:      * layers/hidden_layer_4/input/W size=4500000 type=float32 device=None
2020-07-09 08:45:52,195 add:      * layers/hidden_layer_4/input/b size=3000 type=float32 device=None
2020-07-09 08:45:52,195 __init__: - DropoutLayer name=dropout_layer_5 inputs=[hidden_layer_4] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:52,195 __init__:   dropout_rate=0.200000
2020-07-09 08:45:52,195 __init__: - HighwayLayer name=hidden_layer_5 inputs=[dropout_layer_5] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:57,480 add:      * layers/hidden_layer_5/input/W size=4500000 type=float32 device=None
2020-07-09 08:45:57,480 add:      * layers/hidden_layer_5/input/b size=3000 type=float32 device=None
2020-07-09 08:45:57,480 __init__: - DropoutLayer name=dropout_layer_6 inputs=[hidden_layer_5] size=1500 activation=tanh devices=[None]
2020-07-09 08:45:57,480 __init__:   dropout_rate=0.200000
2020-07-09 08:45:57,481 __init__: - SoftmaxLayer name=output_layer inputs=[dropout_layer_6] size=100003 activation=tanh devices=[None]
2020-07-09 08:46:11,551 add:      * layers/output_layer/input/W size=150004500 type=float32 device=None
2020-07-09 08:46:11,589 add:      * layers/output_layer/input/b size=100003 type=float32 device=None
2020-07-09 08:46:11,589 __init__: Total number of model parameters: 230124003
2020-07-09 08:46:15,815 train: Building optimizer.
2020-07-09 08:46:16,128 add:      * layers/projection_layer/W_sum_sqr_gradient size=50001500 type=float32 device=None
2020-07-09 08:46:16,154 add:      * layers/hidden_layer_1/layer_input/W_sum_sqr_gradient size=3000000 type=float32 device=None
2020-07-09 08:46:16,188 add:      * layers/hidden_layer_1/step_input/W_sum_sqr_gradient size=9000000 type=float32 device=None
2020-07-09 08:46:16,189 add:      * layers/hidden_layer_1/layer_input/b_sum_sqr_gradient size=6000 type=float32 device=None
2020-07-09 08:46:16,200 add:      * layers/hidden_layer_2/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-07-09 08:46:16,200 add:      * layers/hidden_layer_2/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-07-09 08:46:16,210 add:      * layers/hidden_layer_3/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-07-09 08:46:16,210 add:      * layers/hidden_layer_3/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-07-09 08:46:16,220 add:      * layers/hidden_layer_4/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-07-09 08:46:16,220 add:      * layers/hidden_layer_4/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-07-09 08:46:16,229 add:      * layers/hidden_layer_5/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-07-09 08:46:16,230 add:      * layers/hidden_layer_5/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-07-09 08:46:17,106 add:      * layers/output_layer/input/W_sum_sqr_gradient size=150004500 type=float32 device=None
2020-07-09 08:46:17,140 add:      * layers/output_layer/input/b_sum_sqr_gradient size=100003 type=float32 device=None
2020-07-09 08:48:38,307 train: Building text scorer for cross-validation.
2020-07-09 08:49:03,416 train: Validation text: /scratch/work/moisioa3/conv_lm/data/devel/plain.txt
2020-07-09 08:49:03,417 train: Training neural network.
2020-07-09 08:51:14,410 _log_update: [1000] (0.3 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 08:53:24,943 _log_update: [2000] (0.5 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 08:55:35,435 _log_update: [3000] (0.8 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 08:57:45,981 _log_update: [4000] (1.1 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 08:59:56,452 _log_update: [5000] (1.3 %) of epoch 1 -- lr = 1, duration = 12.5 ms
2020-07-09 09:02:07,025 _log_update: [6000] (1.6 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 09:04:17,463 _log_update: [7000] (1.8 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 09:06:28,035 _log_update: [8000] (2.1 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:08:38,478 _log_update: [9000] (2.4 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:10:49,008 _log_update: [10000] (2.6 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:12:59,569 _log_update: [11000] (2.9 %) of epoch 1 -- lr = 1, duration = 12.7 ms
2020-07-09 09:15:09,999 _log_update: [12000] (3.2 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 09:17:20,547 _log_update: [13000] (3.4 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 09:19:31,111 _log_update: [14000] (3.7 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:21:41,662 _log_update: [15000] (4.0 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:23:52,271 _log_update: [16000] (4.2 %) of epoch 1 -- lr = 1, duration = 12.5 ms
2020-07-09 09:26:05,723 _log_update: [17000] (4.5 %) of epoch 1 -- lr = 1, duration = 11.6 ms
2020-07-09 09:28:26,484 _log_update: [18000] (4.7 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 09:30:48,849 _log_update: [19000] (5.0 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 09:33:07,916 _log_update: [20000] (5.3 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 09:35:25,489 _log_update: [21000] (5.5 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:37:41,082 _log_update: [22000] (5.8 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 09:39:56,470 _log_update: [23000] (6.1 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 09:42:13,412 _log_update: [24000] (6.3 %) of epoch 1 -- lr = 1, duration = 11.8 ms
2020-07-09 09:44:28,747 _log_update: [25000] (6.6 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 09:46:42,460 _log_update: [26000] (6.8 %) of epoch 1 -- lr = 1, duration = 12.0 ms
2020-07-09 09:48:56,640 _log_update: [27000] (7.1 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 09:51:10,088 _log_update: [28000] (7.4 %) of epoch 1 -- lr = 1, duration = 12.6 ms
2020-07-09 09:53:23,660 _log_update: [29000] (7.6 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 09:55:36,211 _log_update: [30000] (7.9 %) of epoch 1 -- lr = 1, duration = 12.0 ms
2020-07-09 09:57:48,403 _log_update: [31000] (8.2 %) of epoch 1 -- lr = 1, duration = 12.8 ms
2020-07-09 10:00:00,684 _log_update: [32000] (8.4 %) of epoch 1 -- lr = 1, duration = 12.4 ms
2020-07-09 10:02:12,928 _log_update: [33000] (8.7 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 10:04:24,862 _log_update: [34000] (9.0 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 10:06:36,669 _log_update: [35000] (9.2 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 10:08:48,297 _log_update: [36000] (9.5 %) of epoch 1 -- lr = 1, duration = 12.5 ms
2020-07-09 10:10:59,215 _log_update: [37000] (9.7 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 10:13:10,139 _log_update: [38000] (10.0 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 10:15:20,994 _log_update: [39000] (10.3 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 10:17:31,564 _log_update: [40000] (10.5 %) of epoch 1 -- lr = 1, duration = 12.7 ms
2020-07-09 10:19:42,383 _log_update: [41000] (10.8 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 10:21:53,117 _log_update: [42000] (11.1 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 10:24:03,790 _log_update: [43000] (11.3 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 10:26:14,435 _log_update: [44000] (11.6 %) of epoch 1 -- lr = 1, duration = 12.5 ms
2020-07-09 10:28:25,157 _log_update: [45000] (11.9 %) of epoch 1 -- lr = 1, duration = 13.1 ms
2020-07-09 10:30:35,953 _log_update: [46000] (12.1 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 10:32:46,587 _log_update: [47000] (12.4 %) of epoch 1 -- lr = 1, duration = 13.0 ms
2020-07-09 10:34:57,260 _log_update: [48000] (12.6 %) of epoch 1 -- lr = 1, duration = 12.8 ms
2020-07-09 10:37:08,140 _log_update: [49000] (12.9 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 10:39:18,981 _log_update: [50000] (13.2 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 10:41:29,749 _log_update: [51000] (13.4 %) of epoch 1 -- lr = 1, duration = 12.4 ms
2020-07-09 10:43:40,912 _log_update: [52000] (13.7 %) of epoch 1 -- lr = 1, duration = 12.9 ms
2020-07-09 10:45:52,852 _log_update: [53000] (14.0 %) of epoch 1 -- lr = 1, duration = 12.8 ms
2020-07-09 10:48:51,837 _log_update: [54000] (14.2 %) of epoch 1 -- lr = 1, duration = 11.9 ms
2020-07-09 10:52:34,680 _log_update: [55000] (14.5 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 10:55:13,149 _log_update: [56000] (14.8 %) of epoch 1 -- lr = 1, duration = 12.1 ms
2020-07-09 10:57:47,396 _log_update: [57000] (15.0 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 11:00:15,993 _log_update: [58000] (15.3 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 11:02:43,407 _log_update: [59000] (15.5 %) of epoch 1 -- lr = 1, duration = 12.2 ms
2020-07-09 11:05:06,421 _log_update: [60000] (15.8 %) of epoch 1 -- lr = 1, duration = 11.8 ms
