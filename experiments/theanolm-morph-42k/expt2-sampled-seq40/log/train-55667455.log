Experiment: theanolm-morph-42k/expt2-sampled-seq40
Job ID: 55667455
Task ID: 
Host: gpu29.int.triton.aalto.fi
Start date: Fri Sep 11 17:27:09 EEST 2020
Work directory: /scratch/work/moisioa3/conv_lm/experiments/theanolm-morph-42k/expt2-sampled-seq40
Temporary directory: /tmp/55667455

Currently Loaded Modules:
  1) srilm/default      3) cuda/10.0.130
  2) anaconda3/latest   4) cudnn/7.4.2-cuda

 

floatX=float32,device=cuda0,base_compiledir=/tmp/theano,exception_verbosity=high,openmp=False
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
/scratch/work/groszt1/envs/theanoLM/lib/python3.7/site-packages/theano/gpuarray/dnn.py:184: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version >= v5 and <= v7.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7402 on context None
Mapped name None to device cuda0: Tesla V100-PCIE-32GB (0000:3B:00.0)
TheanoLM 1.3.2
Theano 1.0.4
pygpu 0.7.6
==
+ srun --gres=gpu:1 theanolm train /scratch/work/moisioa3/conv_lm/experiments/theanolm-morph-42k/expt2-sampled-seq40/nnlm.h5 --training-set /scratch/work/moisioa3/conv_lm/data/segmented/42k/dsp.txt /scratch/work/moisioa3/conv_lm/data/segmented/42k/web.txt --validation-file /scratch/work/moisioa3/conv_lm/data/segmented/42k/devel.txt --sequence-length 40 --batch-size 24 --optimization-method adagrad --stopping-criterion annealing-count --cost cross-entropy --learning-rate 0.1 --gradient-decay-rate 0.9 --numerical-stability-term 1e-6 --num-noise-samples 500 --noise-dampening 0.5 --noise-sharing batch --validation-frequency 5 --patience 2 --max-epochs 25 --min-epochs 1 --random-seed 1 --log-level debug --log-interval 1000 --gradient-normalization 5 --architecture /scratch/work/moisioa3/conv_lm/configs/word+proj500+lstm1500+htanh1500x4+dropout0.2+softmax.arch --sampling 1 0.2
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
2020-09-11 17:27:20,289 _read_vocabulary: Constructing vocabulary from training set.
2020-09-11 17:27:56,229 _read_vocabulary: Number of words in vocabulary: 42699
2020-09-11 17:27:56,230 _read_vocabulary: Number of words in shortlist: 42699
2020-09-11 17:27:56,230 _read_vocabulary: Number of word classes: 42699
2020-09-11 17:27:56,231 log_options: Training options:
2020-09-11 17:27:56,231 log_options:   batch_size: 24
2020-09-11 17:27:56,231 log_options:   max_annealing_count: 0
2020-09-11 17:27:56,231 log_options:   max_epochs: 25
2020-09-11 17:27:56,231 log_options:   min_epochs: 1
2020-09-11 17:27:56,231 log_options:   patience: 2
2020-09-11 17:27:56,231 log_options:   sequence_length: 40
2020-09-11 17:27:56,231 log_options:   stopping_criterion: annealing-count
2020-09-11 17:27:56,231 log_options:   validation_frequency: 5
2020-09-11 17:27:56,232 log_options: Optimization options:
2020-09-11 17:27:56,232 log_options:   epsilon=1e-06
2020-09-11 17:27:56,232 log_options:   gradient_decay_rate=0.9
2020-09-11 17:27:56,232 log_options:   learning_rate=0.1
2020-09-11 17:27:56,232 log_options:   max_gradient_norm=5.0
2020-09-11 17:27:56,232 log_options:   method=adagrad
2020-09-11 17:27:56,232 log_options:   momentum=0.9
2020-09-11 17:27:56,232 log_options:   noise_sharing=batch
2020-09-11 17:27:56,232 log_options:   num_noise_samples=500
2020-09-11 17:27:56,232 log_options:   sqr_gradient_decay_rate=0.999
2020-09-11 17:27:56,233 log_options:   weights=[1. 1.]
2020-09-11 17:27:56,233 log_options:   cost_function=cross-entropy
2020-09-11 17:27:56,233 log_options:   noise_distribution=uniform
2020-09-11 17:27:56,233 log_options:   noise_dampening=0
2020-09-11 17:27:56,233 log_options:   noise_sharing=batch
2020-09-11 17:27:56,233 log_options:   exclude_unk=no
2020-09-11 17:27:56,233 log_options:   l1_regularization=0.000000
2020-09-11 17:27:56,233 log_options:   l2_regularization=0.000000
2020-09-11 17:27:56,234 log_options: Data sampling: [1.  0.2]
2020-09-11 17:27:56,234 train: Creating trainer.
Computing the number of mini-batches in training data.
2020-09-11 17:30:56,016 __init__: One epoch of training data contains 375811 mini-batch updates.
2020-09-11 17:30:56,020 __init__: Class unigram log probabilities are in the range [-inf, -3.897650].
2020-09-11 17:30:56,020 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/segmented/42k/dsp.txt.
2020-09-11 17:30:56,023 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/segmented/42k/web.txt.
2020-09-11 17:31:00,251 _reset: Generating a random order of input lines.
2020-09-11 17:31:00,901 train: Building neural network.
2020-09-11 17:31:00,917 get_default_device: Context None device="Tesla V100-PCIE-32GB" ID="0000:3B:00.0"
2020-09-11 17:31:00,945 __init__: Creating layers.
2020-09-11 17:31:00,945 __init__: - NetworkInput name=word_input inputs=[] size=42699 activation=tanh devices=[]
2020-09-11 17:31:00,946 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=500 activation=tanh devices=[None]
2020-09-11 17:31:02,150 add:      * layers/projection_layer/W size=21349500 type=float32 device=None
2020-09-11 17:31:02,158 __init__: - DropoutLayer name=dropout_layer_1 inputs=[projection_layer] size=500 activation=tanh devices=[None]
2020-09-11 17:31:02,158 __init__:   dropout_rate=0.200000
2020-09-11 17:31:02,158 __init__: - LSTMLayer name=hidden_layer_1 inputs=[dropout_layer_1] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:02,300 add:      * layers/hidden_layer_1/layer_input/W size=3000000 type=float32 device=None
2020-09-11 17:31:10,025 add:      * layers/hidden_layer_1/step_input/W size=9000000 type=float32 device=None
2020-09-11 17:31:10,032 add:      * layers/hidden_layer_1/layer_input/b size=6000 type=float32 device=None
2020-09-11 17:31:10,032 __init__: - DropoutLayer name=dropout_layer_2 inputs=[hidden_layer_1] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:10,032 __init__:   dropout_rate=0.200000
2020-09-11 17:31:10,032 __init__: - HighwayLayer name=hidden_layer_2 inputs=[dropout_layer_2] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:13,912 add:      * layers/hidden_layer_2/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:13,912 add:      * layers/hidden_layer_2/input/b size=3000 type=float32 device=None
2020-09-11 17:31:13,913 __init__: - DropoutLayer name=dropout_layer_3 inputs=[hidden_layer_2] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:13,913 __init__:   dropout_rate=0.200000
2020-09-11 17:31:13,913 __init__: - HighwayLayer name=hidden_layer_3 inputs=[dropout_layer_3] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:17,662 add:      * layers/hidden_layer_3/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:17,663 add:      * layers/hidden_layer_3/input/b size=3000 type=float32 device=None
2020-09-11 17:31:17,663 __init__: - DropoutLayer name=dropout_layer_4 inputs=[hidden_layer_3] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:17,663 __init__:   dropout_rate=0.200000
2020-09-11 17:31:17,663 __init__: - HighwayLayer name=hidden_layer_4 inputs=[dropout_layer_4] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:21,338 add:      * layers/hidden_layer_4/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:21,338 add:      * layers/hidden_layer_4/input/b size=3000 type=float32 device=None
2020-09-11 17:31:21,338 __init__: - DropoutLayer name=dropout_layer_5 inputs=[hidden_layer_4] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:21,338 __init__:   dropout_rate=0.200000
2020-09-11 17:31:21,339 __init__: - HighwayLayer name=hidden_layer_5 inputs=[dropout_layer_5] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:25,134 add:      * layers/hidden_layer_5/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:25,135 add:      * layers/hidden_layer_5/input/b size=3000 type=float32 device=None
2020-09-11 17:31:25,135 __init__: - DropoutLayer name=dropout_layer_6 inputs=[hidden_layer_5] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:25,135 __init__:   dropout_rate=0.200000
2020-09-11 17:31:25,135 __init__: - SoftmaxLayer name=output_layer inputs=[dropout_layer_6] size=42699 activation=tanh devices=[None]
2020-09-11 17:31:28,791 add:      * layers/output_layer/input/W size=64048500 type=float32 device=None
2020-09-11 17:31:28,810 add:      * layers/output_layer/input/b size=42699 type=float32 device=None
2020-09-11 17:31:28,810 __init__: Total number of model parameters: 115458699
2020-09-11 17:31:30,022 train: Building optimizer.
2020-09-11 17:31:30,172 add:      * layers/projection_layer/W_sum_sqr_gradient size=21349500 type=float32 device=None
2020-09-11 17:31:30,195 add:      * layers/hidden_layer_1/layer_input/W_sum_sqr_gradient size=3000000 type=float32 device=None
2020-09-11 17:31:30,243 add:      * layers/hidden_layer_1/step_input/W_sum_sqr_gradient size=9000000 type=float32 device=None
2020-09-11 17:31:30,247 add:      * layers/hidden_layer_1/layer_input/b_sum_sqr_gradient size=6000 type=float32 device=None
2020-09-11 17:31:30,258 add:      * layers/hidden_layer_2/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,258 add:      * layers/hidden_layer_2/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,269 add:      * layers/hidden_layer_3/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,269 add:      * layers/hidden_layer_3/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,279 add:      * layers/hidden_layer_4/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,280 add:      * layers/hidden_layer_4/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,290 add:      * layers/hidden_layer_5/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,290 add:      * layers/hidden_layer_5/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,658 add:      * layers/output_layer/input/W_sum_sqr_gradient size=64048500 type=float32 device=None
2020-09-11 17:31:30,674 add:      * layers/output_layer/input/b_sum_sqr_gradient size=42699 type=float32 device=None
2020-09-11 17:33:18,928 train: Building text scorer for cross-validation.
2020-09-11 17:33:37,356 train: Validation text: /scratch/work/moisioa3/conv_lm/data/segmented/42k/devel.txt
2020-09-11 17:33:37,357 train: Training neural network.
2020-09-11 17:38:49,018 _log_update: [1000] (0.3 %) of epoch 1 -- lr = 0.1, duration = 29.4 ms
2020-09-11 17:44:01,747 _log_update: [2000] (0.5 %) of epoch 1 -- lr = 0.1, duration = 34.9 ms
2020-09-11 17:49:12,669 _log_update: [3000] (0.8 %) of epoch 1 -- lr = 0.1, duration = 34.9 ms
2020-09-11 17:54:28,375 _log_update: [4000] (1.1 %) of epoch 1 -- lr = 0.1, duration = 32.4 ms
2020-09-11 17:59:39,630 _log_update: [5000] (1.3 %) of epoch 1 -- lr = 0.1, duration = 32.6 ms
2020-09-11 18:04:56,526 _log_update: [6000] (1.6 %) of epoch 1 -- lr = 0.1, duration = 34.1 ms
2020-09-11 18:10:10,353 _log_update: [7000] (1.9 %) of epoch 1 -- lr = 0.1, duration = 34.1 ms
2020-09-11 18:15:24,616 _log_update: [8000] (2.1 %) of epoch 1 -- lr = 0.1, duration = 33.4 ms
2020-09-11 18:20:35,214 _log_update: [9000] (2.4 %) of epoch 1 -- lr = 0.1, duration = 30.9 ms
2020-09-11 18:25:49,258 _log_update: [10000] (2.7 %) of epoch 1 -- lr = 0.1, duration = 33.1 ms
2020-09-11 18:31:04,822 _log_update: [11000] (2.9 %) of epoch 1 -- lr = 0.1, duration = 33.1 ms
2020-09-11 18:36:20,632 _log_update: [12000] (3.2 %) of epoch 1 -- lr = 0.1, duration = 33.2 ms
2020-09-11 18:41:36,401 _log_update: [13000] (3.5 %) of epoch 1 -- lr = 0.1, duration = 21.2 ms
2020-09-11 18:46:50,561 _log_update: [14000] (3.7 %) of epoch 1 -- lr = 0.1, duration = 30.9 ms
2020-09-11 18:52:01,393 _log_update: [15000] (4.0 %) of epoch 1 -- lr = 0.1, duration = 35.5 ms
2020-09-11 18:57:16,972 _log_update: [16000] (4.3 %) of epoch 1 -- lr = 0.1, duration = 26.1 ms
2020-09-11 19:02:31,830 _log_update: [17000] (4.5 %) of epoch 1 -- lr = 0.1, duration = 33.0 ms
2020-09-11 19:07:46,832 _log_update: [18000] (4.8 %) of epoch 1 -- lr = 0.1, duration = 33.5 ms
2020-09-11 19:13:01,310 _log_update: [19000] (5.1 %) of epoch 1 -- lr = 0.1, duration = 34.2 ms
2020-09-11 19:18:11,826 _log_update: [20000] (5.3 %) of epoch 1 -- lr = 0.1, duration = 19.0 ms
2020-09-11 19:23:26,894 _log_update: [21000] (5.6 %) of epoch 1 -- lr = 0.1, duration = 33.6 ms
2020-09-11 19:28:38,073 _log_update: [22000] (5.9 %) of epoch 1 -- lr = 0.1, duration = 33.5 ms
2020-09-11 19:33:51,561 _log_update: [23000] (6.1 %) of epoch 1 -- lr = 0.1, duration = 32.8 ms
2020-09-11 19:39:03,631 _log_update: [24000] (6.4 %) of epoch 1 -- lr = 0.1, duration = 34.3 ms
2020-09-11 19:44:17,720 _log_update: [25000] (6.7 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 19:49:33,962 _log_update: [26000] (6.9 %) of epoch 1 -- lr = 0.1, duration = 30.4 ms
2020-09-11 19:54:45,758 _log_update: [27000] (7.2 %) of epoch 1 -- lr = 0.1, duration = 29.4 ms
2020-09-11 20:00:00,853 _log_update: [28000] (7.5 %) of epoch 1 -- lr = 0.1, duration = 34.7 ms
2020-09-11 20:05:21,245 _log_update: [29000] (7.7 %) of epoch 1 -- lr = 0.1, duration = 26.5 ms
2020-09-11 20:11:42,568 _log_update: [30000] (8.0 %) of epoch 1 -- lr = 0.1, duration = 19.8 ms
2020-09-11 20:17:36,488 _log_update: [31000] (8.2 %) of epoch 1 -- lr = 0.1, duration = 26.4 ms
2020-09-11 20:23:20,611 _log_update: [32000] (8.5 %) of epoch 1 -- lr = 0.1, duration = 19.8 ms
2020-09-11 20:28:57,247 _log_update: [33000] (8.8 %) of epoch 1 -- lr = 0.1, duration = 31.5 ms
2020-09-11 20:34:34,355 _log_update: [34000] (9.0 %) of epoch 1 -- lr = 0.1, duration = 28.9 ms
2020-09-11 20:40:52,672 _log_update: [35000] (9.3 %) of epoch 1 -- lr = 0.1, duration = 31.3 ms
2020-09-11 20:47:28,839 _log_update: [36000] (9.6 %) of epoch 1 -- lr = 0.1, duration = 27.0 ms
2020-09-11 20:53:48,476 _log_update: [37000] (9.8 %) of epoch 1 -- lr = 0.1, duration = 31.3 ms
2020-09-11 20:59:54,995 _log_update: [38000] (10.1 %) of epoch 1 -- lr = 0.1, duration = 33.0 ms
2020-09-11 21:05:59,848 _log_update: [39000] (10.4 %) of epoch 1 -- lr = 0.1, duration = 23.8 ms
2020-09-11 21:12:02,725 _log_update: [40000] (10.6 %) of epoch 1 -- lr = 0.1, duration = 30.7 ms
2020-09-11 21:17:53,234 _log_update: [41000] (10.9 %) of epoch 1 -- lr = 0.1, duration = 31.6 ms
2020-09-11 21:23:35,784 _log_update: [42000] (11.2 %) of epoch 1 -- lr = 0.1, duration = 26.0 ms
2020-09-11 21:29:14,095 _log_update: [43000] (11.4 %) of epoch 1 -- lr = 0.1, duration = 34.2 ms
2020-09-11 21:35:03,520 _log_update: [44000] (11.7 %) of epoch 1 -- lr = 0.1, duration = 35.2 ms
2020-09-11 21:40:48,751 _log_update: [45000] (12.0 %) of epoch 1 -- lr = 0.1, duration = 14.4 ms
2020-09-11 21:46:34,500 _log_update: [46000] (12.2 %) of epoch 1 -- lr = 0.1, duration = 30.6 ms
2020-09-11 21:52:17,404 _log_update: [47000] (12.5 %) of epoch 1 -- lr = 0.1, duration = 32.0 ms
2020-09-11 21:57:59,594 _log_update: [48000] (12.8 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 22:03:40,977 _log_update: [49000] (13.0 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 22:09:21,368 _log_update: [50000] (13.3 %) of epoch 1 -- lr = 0.1, duration = 30.4 ms
2020-09-11 22:15:04,772 _log_update: [51000] (13.6 %) of epoch 1 -- lr = 0.1, duration = 31.0 ms
2020-09-11 22:20:44,596 _log_update: [52000] (13.8 %) of epoch 1 -- lr = 0.1, duration = 21.4 ms
2020-09-11 22:26:17,702 _log_update: [53000] (14.1 %) of epoch 1 -- lr = 0.1, duration = 26.1 ms
2020-09-11 22:31:47,163 _log_update: [54000] (14.4 %) of epoch 1 -- lr = 0.1, duration = 32.3 ms
2020-09-11 22:37:12,887 _log_update: [55000] (14.6 %) of epoch 1 -- lr = 0.1, duration = 32.6 ms
2020-09-11 22:42:37,631 _log_update: [56000] (14.9 %) of epoch 1 -- lr = 0.1, duration = 33.3 ms
2020-09-11 22:48:03,132 _log_update: [57000] (15.2 %) of epoch 1 -- lr = 0.1, duration = 32.8 ms
2020-09-11 22:53:29,056 _log_update: [58000] (15.4 %) of epoch 1 -- lr = 0.1, duration = 32.3 ms
2020-09-11 22:58:51,841 _log_update: [59000] (15.7 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
