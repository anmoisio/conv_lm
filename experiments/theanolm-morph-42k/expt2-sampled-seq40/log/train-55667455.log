Experiment: theanolm-morph-42k/expt2-sampled-seq40
Job ID: 55667455
Task ID: 
Host: gpu29.int.triton.aalto.fi
Start date: Fri Sep 11 17:27:09 EEST 2020
Work directory: /scratch/work/moisioa3/conv_lm/experiments/theanolm-morph-42k/expt2-sampled-seq40
Temporary directory: /tmp/55667455

Currently Loaded Modules:
  1) srilm/default      3) cuda/10.0.130
  2) anaconda3/latest   4) cudnn/7.4.2-cuda

 

floatX=float32,device=cuda0,base_compiledir=/tmp/theano,exception_verbosity=high,openmp=False
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
/scratch/work/groszt1/envs/theanoLM/lib/python3.7/site-packages/theano/gpuarray/dnn.py:184: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version >= v5 and <= v7.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7402 on context None
Mapped name None to device cuda0: Tesla V100-PCIE-32GB (0000:3B:00.0)
TheanoLM 1.3.2
Theano 1.0.4
pygpu 0.7.6
==
+ srun --gres=gpu:1 theanolm train /scratch/work/moisioa3/conv_lm/experiments/theanolm-morph-42k/expt2-sampled-seq40/nnlm.h5 --training-set /scratch/work/moisioa3/conv_lm/data/segmented/42k/dsp.txt /scratch/work/moisioa3/conv_lm/data/segmented/42k/web.txt --validation-file /scratch/work/moisioa3/conv_lm/data/segmented/42k/devel.txt --sequence-length 40 --batch-size 24 --optimization-method adagrad --stopping-criterion annealing-count --cost cross-entropy --learning-rate 0.1 --gradient-decay-rate 0.9 --numerical-stability-term 1e-6 --num-noise-samples 500 --noise-dampening 0.5 --noise-sharing batch --validation-frequency 5 --patience 2 --max-epochs 25 --min-epochs 1 --random-seed 1 --log-level debug --log-interval 1000 --gradient-normalization 5 --architecture /scratch/work/moisioa3/conv_lm/configs/word+proj500+lstm1500+htanh1500x4+dropout0.2+softmax.arch --sampling 1 0.2
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
2020-09-11 17:27:20,289 _read_vocabulary: Constructing vocabulary from training set.
2020-09-11 17:27:56,229 _read_vocabulary: Number of words in vocabulary: 42699
2020-09-11 17:27:56,230 _read_vocabulary: Number of words in shortlist: 42699
2020-09-11 17:27:56,230 _read_vocabulary: Number of word classes: 42699
2020-09-11 17:27:56,231 log_options: Training options:
2020-09-11 17:27:56,231 log_options:   batch_size: 24
2020-09-11 17:27:56,231 log_options:   max_annealing_count: 0
2020-09-11 17:27:56,231 log_options:   max_epochs: 25
2020-09-11 17:27:56,231 log_options:   min_epochs: 1
2020-09-11 17:27:56,231 log_options:   patience: 2
2020-09-11 17:27:56,231 log_options:   sequence_length: 40
2020-09-11 17:27:56,231 log_options:   stopping_criterion: annealing-count
2020-09-11 17:27:56,231 log_options:   validation_frequency: 5
2020-09-11 17:27:56,232 log_options: Optimization options:
2020-09-11 17:27:56,232 log_options:   epsilon=1e-06
2020-09-11 17:27:56,232 log_options:   gradient_decay_rate=0.9
2020-09-11 17:27:56,232 log_options:   learning_rate=0.1
2020-09-11 17:27:56,232 log_options:   max_gradient_norm=5.0
2020-09-11 17:27:56,232 log_options:   method=adagrad
2020-09-11 17:27:56,232 log_options:   momentum=0.9
2020-09-11 17:27:56,232 log_options:   noise_sharing=batch
2020-09-11 17:27:56,232 log_options:   num_noise_samples=500
2020-09-11 17:27:56,232 log_options:   sqr_gradient_decay_rate=0.999
2020-09-11 17:27:56,233 log_options:   weights=[1. 1.]
2020-09-11 17:27:56,233 log_options:   cost_function=cross-entropy
2020-09-11 17:27:56,233 log_options:   noise_distribution=uniform
2020-09-11 17:27:56,233 log_options:   noise_dampening=0
2020-09-11 17:27:56,233 log_options:   noise_sharing=batch
2020-09-11 17:27:56,233 log_options:   exclude_unk=no
2020-09-11 17:27:56,233 log_options:   l1_regularization=0.000000
2020-09-11 17:27:56,233 log_options:   l2_regularization=0.000000
2020-09-11 17:27:56,234 log_options: Data sampling: [1.  0.2]
2020-09-11 17:27:56,234 train: Creating trainer.
Computing the number of mini-batches in training data.
2020-09-11 17:30:56,016 __init__: One epoch of training data contains 375811 mini-batch updates.
2020-09-11 17:30:56,020 __init__: Class unigram log probabilities are in the range [-inf, -3.897650].
2020-09-11 17:30:56,020 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/segmented/42k/dsp.txt.
2020-09-11 17:30:56,023 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/segmented/42k/web.txt.
2020-09-11 17:31:00,251 _reset: Generating a random order of input lines.
2020-09-11 17:31:00,901 train: Building neural network.
2020-09-11 17:31:00,917 get_default_device: Context None device="Tesla V100-PCIE-32GB" ID="0000:3B:00.0"
2020-09-11 17:31:00,945 __init__: Creating layers.
2020-09-11 17:31:00,945 __init__: - NetworkInput name=word_input inputs=[] size=42699 activation=tanh devices=[]
2020-09-11 17:31:00,946 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=500 activation=tanh devices=[None]
2020-09-11 17:31:02,150 add:      * layers/projection_layer/W size=21349500 type=float32 device=None
2020-09-11 17:31:02,158 __init__: - DropoutLayer name=dropout_layer_1 inputs=[projection_layer] size=500 activation=tanh devices=[None]
2020-09-11 17:31:02,158 __init__:   dropout_rate=0.200000
2020-09-11 17:31:02,158 __init__: - LSTMLayer name=hidden_layer_1 inputs=[dropout_layer_1] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:02,300 add:      * layers/hidden_layer_1/layer_input/W size=3000000 type=float32 device=None
2020-09-11 17:31:10,025 add:      * layers/hidden_layer_1/step_input/W size=9000000 type=float32 device=None
2020-09-11 17:31:10,032 add:      * layers/hidden_layer_1/layer_input/b size=6000 type=float32 device=None
2020-09-11 17:31:10,032 __init__: - DropoutLayer name=dropout_layer_2 inputs=[hidden_layer_1] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:10,032 __init__:   dropout_rate=0.200000
2020-09-11 17:31:10,032 __init__: - HighwayLayer name=hidden_layer_2 inputs=[dropout_layer_2] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:13,912 add:      * layers/hidden_layer_2/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:13,912 add:      * layers/hidden_layer_2/input/b size=3000 type=float32 device=None
2020-09-11 17:31:13,913 __init__: - DropoutLayer name=dropout_layer_3 inputs=[hidden_layer_2] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:13,913 __init__:   dropout_rate=0.200000
2020-09-11 17:31:13,913 __init__: - HighwayLayer name=hidden_layer_3 inputs=[dropout_layer_3] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:17,662 add:      * layers/hidden_layer_3/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:17,663 add:      * layers/hidden_layer_3/input/b size=3000 type=float32 device=None
2020-09-11 17:31:17,663 __init__: - DropoutLayer name=dropout_layer_4 inputs=[hidden_layer_3] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:17,663 __init__:   dropout_rate=0.200000
2020-09-11 17:31:17,663 __init__: - HighwayLayer name=hidden_layer_4 inputs=[dropout_layer_4] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:21,338 add:      * layers/hidden_layer_4/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:21,338 add:      * layers/hidden_layer_4/input/b size=3000 type=float32 device=None
2020-09-11 17:31:21,338 __init__: - DropoutLayer name=dropout_layer_5 inputs=[hidden_layer_4] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:21,338 __init__:   dropout_rate=0.200000
2020-09-11 17:31:21,339 __init__: - HighwayLayer name=hidden_layer_5 inputs=[dropout_layer_5] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:25,134 add:      * layers/hidden_layer_5/input/W size=4500000 type=float32 device=None
2020-09-11 17:31:25,135 add:      * layers/hidden_layer_5/input/b size=3000 type=float32 device=None
2020-09-11 17:31:25,135 __init__: - DropoutLayer name=dropout_layer_6 inputs=[hidden_layer_5] size=1500 activation=tanh devices=[None]
2020-09-11 17:31:25,135 __init__:   dropout_rate=0.200000
2020-09-11 17:31:25,135 __init__: - SoftmaxLayer name=output_layer inputs=[dropout_layer_6] size=42699 activation=tanh devices=[None]
2020-09-11 17:31:28,791 add:      * layers/output_layer/input/W size=64048500 type=float32 device=None
2020-09-11 17:31:28,810 add:      * layers/output_layer/input/b size=42699 type=float32 device=None
2020-09-11 17:31:28,810 __init__: Total number of model parameters: 115458699
2020-09-11 17:31:30,022 train: Building optimizer.
2020-09-11 17:31:30,172 add:      * layers/projection_layer/W_sum_sqr_gradient size=21349500 type=float32 device=None
2020-09-11 17:31:30,195 add:      * layers/hidden_layer_1/layer_input/W_sum_sqr_gradient size=3000000 type=float32 device=None
2020-09-11 17:31:30,243 add:      * layers/hidden_layer_1/step_input/W_sum_sqr_gradient size=9000000 type=float32 device=None
2020-09-11 17:31:30,247 add:      * layers/hidden_layer_1/layer_input/b_sum_sqr_gradient size=6000 type=float32 device=None
2020-09-11 17:31:30,258 add:      * layers/hidden_layer_2/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,258 add:      * layers/hidden_layer_2/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,269 add:      * layers/hidden_layer_3/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,269 add:      * layers/hidden_layer_3/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,279 add:      * layers/hidden_layer_4/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,280 add:      * layers/hidden_layer_4/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,290 add:      * layers/hidden_layer_5/input/W_sum_sqr_gradient size=4500000 type=float32 device=None
2020-09-11 17:31:30,290 add:      * layers/hidden_layer_5/input/b_sum_sqr_gradient size=3000 type=float32 device=None
2020-09-11 17:31:30,658 add:      * layers/output_layer/input/W_sum_sqr_gradient size=64048500 type=float32 device=None
2020-09-11 17:31:30,674 add:      * layers/output_layer/input/b_sum_sqr_gradient size=42699 type=float32 device=None
2020-09-11 17:33:18,928 train: Building text scorer for cross-validation.
2020-09-11 17:33:37,356 train: Validation text: /scratch/work/moisioa3/conv_lm/data/segmented/42k/devel.txt
2020-09-11 17:33:37,357 train: Training neural network.
2020-09-11 17:38:49,018 _log_update: [1000] (0.3 %) of epoch 1 -- lr = 0.1, duration = 29.4 ms
2020-09-11 17:44:01,747 _log_update: [2000] (0.5 %) of epoch 1 -- lr = 0.1, duration = 34.9 ms
2020-09-11 17:49:12,669 _log_update: [3000] (0.8 %) of epoch 1 -- lr = 0.1, duration = 34.9 ms
2020-09-11 17:54:28,375 _log_update: [4000] (1.1 %) of epoch 1 -- lr = 0.1, duration = 32.4 ms
2020-09-11 17:59:39,630 _log_update: [5000] (1.3 %) of epoch 1 -- lr = 0.1, duration = 32.6 ms
2020-09-11 18:04:56,526 _log_update: [6000] (1.6 %) of epoch 1 -- lr = 0.1, duration = 34.1 ms
2020-09-11 18:10:10,353 _log_update: [7000] (1.9 %) of epoch 1 -- lr = 0.1, duration = 34.1 ms
2020-09-11 18:15:24,616 _log_update: [8000] (2.1 %) of epoch 1 -- lr = 0.1, duration = 33.4 ms
2020-09-11 18:20:35,214 _log_update: [9000] (2.4 %) of epoch 1 -- lr = 0.1, duration = 30.9 ms
2020-09-11 18:25:49,258 _log_update: [10000] (2.7 %) of epoch 1 -- lr = 0.1, duration = 33.1 ms
2020-09-11 18:31:04,822 _log_update: [11000] (2.9 %) of epoch 1 -- lr = 0.1, duration = 33.1 ms
2020-09-11 18:36:20,632 _log_update: [12000] (3.2 %) of epoch 1 -- lr = 0.1, duration = 33.2 ms
2020-09-11 18:41:36,401 _log_update: [13000] (3.5 %) of epoch 1 -- lr = 0.1, duration = 21.2 ms
2020-09-11 18:46:50,561 _log_update: [14000] (3.7 %) of epoch 1 -- lr = 0.1, duration = 30.9 ms
2020-09-11 18:52:01,393 _log_update: [15000] (4.0 %) of epoch 1 -- lr = 0.1, duration = 35.5 ms
2020-09-11 18:57:16,972 _log_update: [16000] (4.3 %) of epoch 1 -- lr = 0.1, duration = 26.1 ms
2020-09-11 19:02:31,830 _log_update: [17000] (4.5 %) of epoch 1 -- lr = 0.1, duration = 33.0 ms
2020-09-11 19:07:46,832 _log_update: [18000] (4.8 %) of epoch 1 -- lr = 0.1, duration = 33.5 ms
2020-09-11 19:13:01,310 _log_update: [19000] (5.1 %) of epoch 1 -- lr = 0.1, duration = 34.2 ms
2020-09-11 19:18:11,826 _log_update: [20000] (5.3 %) of epoch 1 -- lr = 0.1, duration = 19.0 ms
2020-09-11 19:23:26,894 _log_update: [21000] (5.6 %) of epoch 1 -- lr = 0.1, duration = 33.6 ms
2020-09-11 19:28:38,073 _log_update: [22000] (5.9 %) of epoch 1 -- lr = 0.1, duration = 33.5 ms
2020-09-11 19:33:51,561 _log_update: [23000] (6.1 %) of epoch 1 -- lr = 0.1, duration = 32.8 ms
2020-09-11 19:39:03,631 _log_update: [24000] (6.4 %) of epoch 1 -- lr = 0.1, duration = 34.3 ms
2020-09-11 19:44:17,720 _log_update: [25000] (6.7 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 19:49:33,962 _log_update: [26000] (6.9 %) of epoch 1 -- lr = 0.1, duration = 30.4 ms
2020-09-11 19:54:45,758 _log_update: [27000] (7.2 %) of epoch 1 -- lr = 0.1, duration = 29.4 ms
2020-09-11 20:00:00,853 _log_update: [28000] (7.5 %) of epoch 1 -- lr = 0.1, duration = 34.7 ms
2020-09-11 20:05:21,245 _log_update: [29000] (7.7 %) of epoch 1 -- lr = 0.1, duration = 26.5 ms
2020-09-11 20:11:42,568 _log_update: [30000] (8.0 %) of epoch 1 -- lr = 0.1, duration = 19.8 ms
2020-09-11 20:17:36,488 _log_update: [31000] (8.2 %) of epoch 1 -- lr = 0.1, duration = 26.4 ms
2020-09-11 20:23:20,611 _log_update: [32000] (8.5 %) of epoch 1 -- lr = 0.1, duration = 19.8 ms
2020-09-11 20:28:57,247 _log_update: [33000] (8.8 %) of epoch 1 -- lr = 0.1, duration = 31.5 ms
2020-09-11 20:34:34,355 _log_update: [34000] (9.0 %) of epoch 1 -- lr = 0.1, duration = 28.9 ms
2020-09-11 20:40:52,672 _log_update: [35000] (9.3 %) of epoch 1 -- lr = 0.1, duration = 31.3 ms
2020-09-11 20:47:28,839 _log_update: [36000] (9.6 %) of epoch 1 -- lr = 0.1, duration = 27.0 ms
2020-09-11 20:53:48,476 _log_update: [37000] (9.8 %) of epoch 1 -- lr = 0.1, duration = 31.3 ms
2020-09-11 20:59:54,995 _log_update: [38000] (10.1 %) of epoch 1 -- lr = 0.1, duration = 33.0 ms
2020-09-11 21:05:59,848 _log_update: [39000] (10.4 %) of epoch 1 -- lr = 0.1, duration = 23.8 ms
2020-09-11 21:12:02,725 _log_update: [40000] (10.6 %) of epoch 1 -- lr = 0.1, duration = 30.7 ms
2020-09-11 21:17:53,234 _log_update: [41000] (10.9 %) of epoch 1 -- lr = 0.1, duration = 31.6 ms
2020-09-11 21:23:35,784 _log_update: [42000] (11.2 %) of epoch 1 -- lr = 0.1, duration = 26.0 ms
2020-09-11 21:29:14,095 _log_update: [43000] (11.4 %) of epoch 1 -- lr = 0.1, duration = 34.2 ms
2020-09-11 21:35:03,520 _log_update: [44000] (11.7 %) of epoch 1 -- lr = 0.1, duration = 35.2 ms
2020-09-11 21:40:48,751 _log_update: [45000] (12.0 %) of epoch 1 -- lr = 0.1, duration = 14.4 ms
2020-09-11 21:46:34,500 _log_update: [46000] (12.2 %) of epoch 1 -- lr = 0.1, duration = 30.6 ms
2020-09-11 21:52:17,404 _log_update: [47000] (12.5 %) of epoch 1 -- lr = 0.1, duration = 32.0 ms
2020-09-11 21:57:59,594 _log_update: [48000] (12.8 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 22:03:40,977 _log_update: [49000] (13.0 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 22:09:21,368 _log_update: [50000] (13.3 %) of epoch 1 -- lr = 0.1, duration = 30.4 ms
2020-09-11 22:15:04,772 _log_update: [51000] (13.6 %) of epoch 1 -- lr = 0.1, duration = 31.0 ms
2020-09-11 22:20:44,596 _log_update: [52000] (13.8 %) of epoch 1 -- lr = 0.1, duration = 21.4 ms
2020-09-11 22:26:17,702 _log_update: [53000] (14.1 %) of epoch 1 -- lr = 0.1, duration = 26.1 ms
2020-09-11 22:31:47,163 _log_update: [54000] (14.4 %) of epoch 1 -- lr = 0.1, duration = 32.3 ms
2020-09-11 22:37:12,887 _log_update: [55000] (14.6 %) of epoch 1 -- lr = 0.1, duration = 32.6 ms
2020-09-11 22:42:37,631 _log_update: [56000] (14.9 %) of epoch 1 -- lr = 0.1, duration = 33.3 ms
2020-09-11 22:48:03,132 _log_update: [57000] (15.2 %) of epoch 1 -- lr = 0.1, duration = 32.8 ms
2020-09-11 22:53:29,056 _log_update: [58000] (15.4 %) of epoch 1 -- lr = 0.1, duration = 32.3 ms
2020-09-11 22:58:51,841 _log_update: [59000] (15.7 %) of epoch 1 -- lr = 0.1, duration = 31.2 ms
2020-09-11 23:04:18,518 _log_update: [60000] (16.0 %) of epoch 1 -- lr = 0.1, duration = 35.0 ms
2020-09-11 23:09:48,536 _log_update: [61000] (16.2 %) of epoch 1 -- lr = 0.1, duration = 22.6 ms
2020-09-11 23:15:17,500 _log_update: [62000] (16.5 %) of epoch 1 -- lr = 0.1, duration = 26.3 ms
2020-09-11 23:20:45,220 _log_update: [63000] (16.8 %) of epoch 1 -- lr = 0.1, duration = 18.2 ms
2020-09-11 23:26:13,882 _log_update: [64000] (17.0 %) of epoch 1 -- lr = 0.1, duration = 26.6 ms
2020-09-11 23:31:37,609 _log_update: [65000] (17.3 %) of epoch 1 -- lr = 0.1, duration = 32.5 ms
2020-09-11 23:37:03,616 _log_update: [66000] (17.6 %) of epoch 1 -- lr = 0.1, duration = 30.3 ms
2020-09-11 23:42:35,270 _log_update: [67000] (17.8 %) of epoch 1 -- lr = 0.1, duration = 24.7 ms
2020-09-11 23:48:00,880 _log_update: [68000] (18.1 %) of epoch 1 -- lr = 0.1, duration = 26.4 ms
2020-09-11 23:53:26,742 _log_update: [69000] (18.4 %) of epoch 1 -- lr = 0.1, duration = 26.3 ms
2020-09-11 23:58:51,279 _log_update: [70000] (18.6 %) of epoch 1 -- lr = 0.1, duration = 33.6 ms
2020-09-12 00:04:17,154 _log_update: [71000] (18.9 %) of epoch 1 -- lr = 0.1, duration = 30.9 ms
2020-09-12 00:09:40,629 _log_update: [72000] (19.2 %) of epoch 1 -- lr = 0.1, duration = 23.3 ms
2020-09-12 00:15:00,932 _log_update: [73000] (19.4 %) of epoch 1 -- lr = 0.1, duration = 29.4 ms
2020-09-12 00:20:22,044 _log_update: [74000] (19.7 %) of epoch 1 -- lr = 0.1, duration = 33.1 ms
2020-09-12 00:25:40,608 _log_update: [75000] (20.0 %) of epoch 1 -- lr = 0.1, duration = 21.2 ms
2020-09-12 00:26:31,627 _validate: [75157] First validation sample, perplexity 280.74.
2020-09-12 00:26:35,880 _validate: [75160] Center of validation, perplexity 280.54.
2020-09-12 00:26:42,749 _validate: [75163] Last validation sample, perplexity 281.08.
2020-09-12 00:26:45,395 _set_candidate_state: New candidate for optimal state saved to /scratch/work/moisioa3/conv_lm/experiments/theanolm-morph-42k/expt2-sampled-seq40/nnlm.h5.
2020-09-12 00:26:45,395 _log_validation: [75163] Validation set cost history: [281.0]
2020-09-12 00:27:40,673 _reset: Generating a random order of input lines.
Finished training epoch 1 in 6 hours 54.1 minutes. Best validation perplexity 280.99.
2020-09-12 00:31:11,927 _log_update: [667] (0.2 %) of epoch 2 -- lr = 0.1, duration = 31.4 ms
2020-09-12 00:36:31,075 _log_update: [1667] (0.4 %) of epoch 2 -- lr = 0.1, duration = 21.2 ms
2020-09-12 00:41:49,210 _log_update: [2667] (0.7 %) of epoch 2 -- lr = 0.1, duration = 36.4 ms
2020-09-12 00:47:07,489 _log_update: [3667] (1.0 %) of epoch 2 -- lr = 0.1, duration = 33.6 ms
2020-09-12 00:52:27,553 _log_update: [4667] (1.2 %) of epoch 2 -- lr = 0.1, duration = 33.8 ms
2020-09-12 00:57:49,562 _log_update: [5667] (1.5 %) of epoch 2 -- lr = 0.1, duration = 34.1 ms
2020-09-12 01:03:11,727 _log_update: [6667] (1.8 %) of epoch 2 -- lr = 0.1, duration = 33.4 ms
2020-09-12 01:08:31,748 _log_update: [7667] (2.0 %) of epoch 2 -- lr = 0.1, duration = 29.5 ms
2020-09-12 01:13:52,366 _log_update: [8667] (2.3 %) of epoch 2 -- lr = 0.1, duration = 23.7 ms
2020-09-12 01:19:15,311 _log_update: [9667] (2.6 %) of epoch 2 -- lr = 0.1, duration = 33.0 ms
2020-09-12 01:24:36,157 _log_update: [10667] (2.8 %) of epoch 2 -- lr = 0.1, duration = 24.4 ms
2020-09-12 01:29:56,449 _log_update: [11667] (3.1 %) of epoch 2 -- lr = 0.1, duration = 32.8 ms
2020-09-12 01:35:16,097 _log_update: [12667] (3.4 %) of epoch 2 -- lr = 0.1, duration = 33.4 ms
2020-09-12 01:40:34,579 _log_update: [13667] (3.6 %) of epoch 2 -- lr = 0.1, duration = 31.4 ms
2020-09-12 01:45:49,574 _log_update: [14667] (3.9 %) of epoch 2 -- lr = 0.1, duration = 29.8 ms
2020-09-12 01:51:00,411 _log_update: [15667] (4.2 %) of epoch 2 -- lr = 0.1, duration = 30.3 ms
2020-09-12 01:56:11,095 _log_update: [16667] (4.4 %) of epoch 2 -- lr = 0.1, duration = 34.6 ms
2020-09-12 02:01:26,952 _log_update: [17667] (4.7 %) of epoch 2 -- lr = 0.1, duration = 26.0 ms
2020-09-12 02:06:45,326 _log_update: [18667] (5.0 %) of epoch 2 -- lr = 0.1, duration = 33.2 ms
2020-09-12 02:12:02,415 _log_update: [19667] (5.2 %) of epoch 2 -- lr = 0.1, duration = 33.7 ms
2020-09-12 02:17:19,467 _log_update: [20667] (5.5 %) of epoch 2 -- lr = 0.1, duration = 27.6 ms
2020-09-12 02:22:36,507 _log_update: [21667] (5.8 %) of epoch 2 -- lr = 0.1, duration = 32.4 ms
2020-09-12 02:27:54,879 _log_update: [22667] (6.0 %) of epoch 2 -- lr = 0.1, duration = 31.5 ms
2020-09-12 02:33:14,816 _log_update: [23667] (6.3 %) of epoch 2 -- lr = 0.1, duration = 25.9 ms
2020-09-12 02:38:33,346 _log_update: [24667] (6.6 %) of epoch 2 -- lr = 0.1, duration = 35.5 ms
2020-09-12 02:43:50,516 _log_update: [25667] (6.8 %) of epoch 2 -- lr = 0.1, duration = 34.0 ms
2020-09-12 02:49:11,766 _log_update: [26667] (7.1 %) of epoch 2 -- lr = 0.1, duration = 32.6 ms
2020-09-12 02:54:35,508 _log_update: [27667] (7.4 %) of epoch 2 -- lr = 0.1, duration = 29.0 ms
2020-09-12 02:59:58,383 _log_update: [28667] (7.6 %) of epoch 2 -- lr = 0.1, duration = 31.1 ms
2020-09-12 03:05:19,012 _log_update: [29667] (7.9 %) of epoch 2 -- lr = 0.1, duration = 28.7 ms
2020-09-12 03:10:36,887 _log_update: [30667] (8.2 %) of epoch 2 -- lr = 0.1, duration = 32.2 ms
2020-09-12 03:15:54,266 _log_update: [31667] (8.4 %) of epoch 2 -- lr = 0.1, duration = 26.2 ms
2020-09-12 03:21:12,801 _log_update: [32667] (8.7 %) of epoch 2 -- lr = 0.1, duration = 30.9 ms
2020-09-12 03:26:33,064 _log_update: [33667] (9.0 %) of epoch 2 -- lr = 0.1, duration = 35.8 ms
2020-09-12 03:31:50,383 _log_update: [34667] (9.2 %) of epoch 2 -- lr = 0.1, duration = 32.3 ms
2020-09-12 03:37:10,658 _log_update: [35667] (9.5 %) of epoch 2 -- lr = 0.1, duration = 33.4 ms
2020-09-12 03:42:26,720 _log_update: [36667] (9.8 %) of epoch 2 -- lr = 0.1, duration = 26.6 ms
2020-09-12 03:47:41,660 _log_update: [37667] (10.0 %) of epoch 2 -- lr = 0.1, duration = 34.5 ms
2020-09-12 03:52:57,756 _log_update: [38667] (10.3 %) of epoch 2 -- lr = 0.1, duration = 32.6 ms
2020-09-12 03:58:15,508 _log_update: [39667] (10.6 %) of epoch 2 -- lr = 0.1, duration = 29.3 ms
2020-09-12 04:03:33,177 _log_update: [40667] (10.8 %) of epoch 2 -- lr = 0.1, duration = 28.1 ms
2020-09-12 04:08:49,561 _log_update: [41667] (11.1 %) of epoch 2 -- lr = 0.1, duration = 29.4 ms
2020-09-12 04:14:06,027 _log_update: [42667] (11.4 %) of epoch 2 -- lr = 0.1, duration = 33.3 ms
2020-09-12 04:19:22,806 _log_update: [43667] (11.6 %) of epoch 2 -- lr = 0.1, duration = 29.2 ms
2020-09-12 04:24:39,888 _log_update: [44667] (11.9 %) of epoch 2 -- lr = 0.1, duration = 33.5 ms
2020-09-12 04:29:57,283 _log_update: [45667] (12.2 %) of epoch 2 -- lr = 0.1, duration = 32.3 ms
2020-09-12 04:35:14,468 _log_update: [46667] (12.4 %) of epoch 2 -- lr = 0.1, duration = 33.1 ms
2020-09-12 04:40:30,716 _log_update: [47667] (12.7 %) of epoch 2 -- lr = 0.1, duration = 33.9 ms
2020-09-12 04:45:50,305 _log_update: [48667] (12.9 %) of epoch 2 -- lr = 0.1, duration = 26.7 ms
2020-09-12 04:51:07,641 _log_update: [49667] (13.2 %) of epoch 2 -- lr = 0.1, duration = 34.7 ms
2020-09-12 04:56:23,879 _log_update: [50667] (13.5 %) of epoch 2 -- lr = 0.1, duration = 34.8 ms
2020-09-12 05:01:41,351 _log_update: [51667] (13.7 %) of epoch 2 -- lr = 0.1, duration = 19.6 ms
2020-09-12 05:07:01,921 _log_update: [52667] (14.0 %) of epoch 2 -- lr = 0.1, duration = 36.2 ms
2020-09-12 05:12:20,192 _log_update: [53667] (14.3 %) of epoch 2 -- lr = 0.1, duration = 36.7 ms
2020-09-12 05:17:38,226 _log_update: [54667] (14.5 %) of epoch 2 -- lr = 0.1, duration = 35.7 ms
2020-09-12 05:22:54,763 _log_update: [55667] (14.8 %) of epoch 2 -- lr = 0.1, duration = 22.2 ms
2020-09-12 05:28:09,817 _log_update: [56667] (15.1 %) of epoch 2 -- lr = 0.1, duration = 24.4 ms
2020-09-12 05:33:24,710 _log_update: [57667] (15.3 %) of epoch 2 -- lr = 0.1, duration = 33.8 ms
2020-09-12 05:38:42,869 _log_update: [58667] (15.6 %) of epoch 2 -- lr = 0.1, duration = 20.3 ms
2020-09-12 05:44:00,706 _log_update: [59667] (15.9 %) of epoch 2 -- lr = 0.1, duration = 35.9 ms
2020-09-12 05:49:19,006 _log_update: [60667] (16.1 %) of epoch 2 -- lr = 0.1, duration = 35.6 ms
2020-09-12 05:54:33,640 _log_update: [61667] (16.4 %) of epoch 2 -- lr = 0.1, duration = 21.6 ms
2020-09-12 05:59:51,437 _log_update: [62667] (16.7 %) of epoch 2 -- lr = 0.1, duration = 29.9 ms
2020-09-12 06:05:05,816 _log_update: [63667] (16.9 %) of epoch 2 -- lr = 0.1, duration = 34.2 ms
2020-09-12 06:10:20,410 _log_update: [64667] (17.2 %) of epoch 2 -- lr = 0.1, duration = 32.1 ms
2020-09-12 06:15:35,391 _log_update: [65667] (17.5 %) of epoch 2 -- lr = 0.1, duration = 33.3 ms
2020-09-12 06:20:48,055 _log_update: [66667] (17.7 %) of epoch 2 -- lr = 0.1, duration = 25.1 ms
2020-09-12 06:25:57,601 _log_update: [67667] (18.0 %) of epoch 2 -- lr = 0.1, duration = 33.2 ms
2020-09-12 06:31:10,636 _log_update: [68667] (18.3 %) of epoch 2 -- lr = 0.1, duration = 23.9 ms
2020-09-12 06:36:26,684 _log_update: [69667] (18.5 %) of epoch 2 -- lr = 0.1, duration = 32.4 ms
2020-09-12 06:41:44,355 _log_update: [70667] (18.8 %) of epoch 2 -- lr = 0.1, duration = 26.7 ms
2020-09-12 06:47:01,651 _log_update: [71667] (19.1 %) of epoch 2 -- lr = 0.1, duration = 30.3 ms
2020-09-12 06:52:18,390 _log_update: [72667] (19.3 %) of epoch 2 -- lr = 0.1, duration = 33.4 ms
2020-09-12 06:57:36,617 _log_update: [73667] (19.6 %) of epoch 2 -- lr = 0.1, duration = 26.9 ms
2020-09-12 07:02:53,231 _log_update: [74667] (19.9 %) of epoch 2 -- lr = 0.1, duration = 27.6 ms
2020-09-12 07:05:31,470 _validate: [75157] First validation sample, perplexity 218.82.
2020-09-12 07:05:35,765 _validate: [75160] Center of validation, perplexity 220.05.
2020-09-12 07:05:42,480 _validate: [75163] Last validation sample, perplexity 219.82.
2020-09-12 07:05:45,045 _set_candidate_state: New candidate for optimal state saved to /scratch/work/moisioa3/conv_lm/experiments/theanolm-morph-42k/expt2-sampled-seq40/nnlm.h5.
2020-09-12 07:05:45,045 _log_validation: [75163] Validation set cost history: 281.0 [219.8]
2020-09-12 07:06:32,070 _reset: Generating a random order of input lines.
Finished training epoch 2 in 6 hours 38.9 minutes. Best validation perplexity 219.82.
2020-09-12 07:08:25,414 _log_update: [354] (0.1 %) of epoch 3 -- lr = 0.1, duration = 27.5 ms
2020-09-12 07:13:41,640 _log_update: [1354] (0.4 %) of epoch 3 -- lr = 0.1, duration = 32.8 ms
2020-09-12 07:18:55,527 _log_update: [2354] (0.6 %) of epoch 3 -- lr = 0.1, duration = 34.3 ms
2020-09-12 07:24:12,509 _log_update: [3354] (0.9 %) of epoch 3 -- lr = 0.1, duration = 30.9 ms
2020-09-12 07:29:26,654 _log_update: [4354] (1.2 %) of epoch 3 -- lr = 0.1, duration = 33.4 ms
2020-09-12 07:34:45,184 _log_update: [5354] (1.4 %) of epoch 3 -- lr = 0.1, duration = 33.6 ms
2020-09-12 07:40:01,415 _log_update: [6354] (1.7 %) of epoch 3 -- lr = 0.1, duration = 33.5 ms
2020-09-12 07:45:16,978 _log_update: [7354] (2.0 %) of epoch 3 -- lr = 0.1, duration = 34.8 ms
2020-09-12 07:50:35,297 _log_update: [8354] (2.2 %) of epoch 3 -- lr = 0.1, duration = 33.3 ms
2020-09-12 07:55:53,548 _log_update: [9354] (2.5 %) of epoch 3 -- lr = 0.1, duration = 37.6 ms
2020-09-12 08:01:09,513 _log_update: [10354] (2.8 %) of epoch 3 -- lr = 0.1, duration = 29.3 ms
2020-09-12 08:06:25,637 _log_update: [11354] (3.0 %) of epoch 3 -- lr = 0.1, duration = 19.9 ms
2020-09-12 08:11:45,425 _log_update: [12354] (3.3 %) of epoch 3 -- lr = 0.1, duration = 35.2 ms
2020-09-12 08:17:03,302 _log_update: [13354] (3.6 %) of epoch 3 -- lr = 0.1, duration = 20.7 ms
2020-09-12 08:22:19,480 _log_update: [14354] (3.8 %) of epoch 3 -- lr = 0.1, duration = 33.8 ms
2020-09-12 08:27:35,787 _log_update: [15354] (4.1 %) of epoch 3 -- lr = 0.1, duration = 23.1 ms
2020-09-12 08:32:53,146 _log_update: [16354] (4.4 %) of epoch 3 -- lr = 0.1, duration = 35.0 ms
2020-09-12 08:38:09,009 _log_update: [17354] (4.6 %) of epoch 3 -- lr = 0.1, duration = 25.0 ms
2020-09-12 08:43:24,704 _log_update: [18354] (4.9 %) of epoch 3 -- lr = 0.1, duration = 33.2 ms
2020-09-12 08:48:44,148 _log_update: [19354] (5.1 %) of epoch 3 -- lr = 0.1, duration = 35.0 ms
2020-09-12 08:54:01,021 _log_update: [20354] (5.4 %) of epoch 3 -- lr = 0.1, duration = 33.1 ms
2020-09-12 08:59:18,228 _log_update: [21354] (5.7 %) of epoch 3 -- lr = 0.1, duration = 34.4 ms
2020-09-12 09:04:36,234 _log_update: [22354] (5.9 %) of epoch 3 -- lr = 0.1, duration = 34.0 ms
2020-09-12 09:09:53,667 _log_update: [23354] (6.2 %) of epoch 3 -- lr = 0.1, duration = 34.7 ms
2020-09-12 09:15:07,470 _log_update: [24354] (6.5 %) of epoch 3 -- lr = 0.1, duration = 35.7 ms
2020-09-12 09:20:26,648 _log_update: [25354] (6.7 %) of epoch 3 -- lr = 0.1, duration = 33.4 ms
2020-09-12 09:25:45,390 _log_update: [26354] (7.0 %) of epoch 3 -- lr = 0.1, duration = 30.4 ms
2020-09-12 09:31:00,608 _log_update: [27354] (7.3 %) of epoch 3 -- lr = 0.1, duration = 33.1 ms
2020-09-12 09:36:16,467 _log_update: [28354] (7.5 %) of epoch 3 -- lr = 0.1, duration = 33.5 ms
2020-09-12 09:41:29,560 _log_update: [29354] (7.8 %) of epoch 3 -- lr = 0.1, duration = 35.7 ms
2020-09-12 09:46:45,020 _log_update: [30354] (8.1 %) of epoch 3 -- lr = 0.1, duration = 23.2 ms
2020-09-12 09:52:00,678 _log_update: [31354] (8.3 %) of epoch 3 -- lr = 0.1, duration = 34.2 ms
2020-09-12 09:57:15,534 _log_update: [32354] (8.6 %) of epoch 3 -- lr = 0.1, duration = 27.6 ms
2020-09-12 10:02:31,228 _log_update: [33354] (8.9 %) of epoch 3 -- lr = 0.1, duration = 33.0 ms
2020-09-12 10:07:47,653 _log_update: [34354] (9.1 %) of epoch 3 -- lr = 0.1, duration = 33.6 ms
2020-09-12 10:13:05,216 _log_update: [35354] (9.4 %) of epoch 3 -- lr = 0.1, duration = 28.8 ms
2020-09-12 10:18:22,105 _log_update: [36354] (9.7 %) of epoch 3 -- lr = 0.1, duration = 35.5 ms
2020-09-12 10:23:37,020 _log_update: [37354] (9.9 %) of epoch 3 -- lr = 0.1, duration = 24.4 ms
2020-09-12 10:28:50,225 _log_update: [38354] (10.2 %) of epoch 3 -- lr = 0.1, duration = 34.3 ms
2020-09-12 10:34:03,519 _log_update: [39354] (10.5 %) of epoch 3 -- lr = 0.1, duration = 33.6 ms
2020-09-12 10:39:20,383 _log_update: [40354] (10.7 %) of epoch 3 -- lr = 0.1, duration = 35.2 ms
2020-09-12 10:44:33,297 _log_update: [41354] (11.0 %) of epoch 3 -- lr = 0.1, duration = 35.4 ms
2020-09-12 10:49:47,017 _log_update: [42354] (11.3 %) of epoch 3 -- lr = 0.1, duration = 32.7 ms
2020-09-12 10:54:57,696 _log_update: [43354] (11.5 %) of epoch 3 -- lr = 0.1, duration = 32.5 ms
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 55667455.0 ON gpu29 CANCELLED AT 2020-09-12T10:58:52 ***
slurmstepd: error: *** JOB 55667455 ON gpu29 CANCELLED AT 2020-09-12T10:58:52 ***
Job has already finished for job 55667455
