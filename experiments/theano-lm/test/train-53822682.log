EXPT_NAME theano-lm
EXPT_PARAMS test
EXPT_WORK_DIR /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test
Experiment: theano-lm/test
Job ID: 53822682
Task ID: 
Host: gpu36.int.triton.aalto.fi
Start date: Sun Jun 14 13:12:06 EEST 2020
Work directory: /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test
Temporary directory: /tmp/53822682
/scratch/elec/puhe/Modules/opt/Theano/Theano-f1e4ec4/lib/python3.6/site-packages
floatX=float32,device=cuda0,base_compiledir=/tmp/theano-53822682,exception_verbosity=high
/scratch/elec/puhe/Modules/opt/Theano/Theano-f1e4ec4/lib/python3.6/site-packages/Theano-1.0.4+unknown-py3.6.egg/theano/gpuarray/dnn.py:184: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version >= v5 and <= v7.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7600 on context None
Mapped name None to device cuda0: Tesla V100-PCIE-32GB (0000:86:00.0)
TheanoLM 1.3.0
Theano 1.0.4+unknown
pygpu 0.7.6
==
I found gzip in your path.  So I'll support compressed input.
Adding words from text file /scratch/work/moisioa3/conv_lm/data/devel/plain.txt into vocabulary.
Adding words from text file /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt into vocabulary.
Adding words from text file /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt into vocabulary.
Estimating logprobs for /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt. It has all but 2414849 vocabulary words.
Estimating logprobs for /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt. It has all but 1778 vocabulary words.
Iter 0: lambdas = (0.5 0.5)
Iter 1: lambdas = (0.500574 0.499426) log P(held-out) = -135177.7419 PPL = 2579.9294
Iter 2: lambdas = (0.501006 0.498994) log P(held-out) = -135177.7220 PPL = 2579.9264
Iter 3: lambdas = (0.501331 0.498669) log P(held-out) = -135177.7108 PPL = 2579.9247
Iter 4: lambdas = (0.501576 0.498424) log P(held-out) = -135177.7044 PPL = 2579.9238
Iter 5: lambdas = (0.501761 0.498239) log P(held-out) = -135177.7008 PPL = 2579.9232
Iter 6: lambdas = (0.501899 0.498101) log P(held-out) = -135177.6987 PPL = 2579.9229
Iter 7: lambdas = (0.502004 0.497996) log P(held-out) = -135177.6976 PPL = 2579.9227
Iter 8: lambdas = (0.502082 0.497918) log P(held-out) = -135177.6969 PPL = 2579.9227
Iter 9: lambdas = (0.502142 0.497858) log P(held-out) = -135177.6965 PPL = 2579.9226
Iter 10: lambdas = (0.502186 0.497814) log P(held-out) = -135177.6963 PPL = 2579.9226
Iter 11: lambdas = (0.502220 0.497780) log P(held-out) = -135177.6962 PPL = 2579.9225
Iter 12: lambdas = (0.502245 0.497755) log P(held-out) = -135177.6961 PPL = 2579.9225
Iter 13: lambdas = (0.502264 0.497736) log P(held-out) = -135177.6961 PPL = 2579.9225
Iter 14: lambdas = (0.502278 0.497722) log P(held-out) = -135177.6961 PPL = 2579.9225
Iter 15: lambdas = (0.502289 0.497711) log P(held-out) = -135177.6961 PPL = 2579.9225
Iter 16: lambdas = (0.502297 0.497703) log P(held-out) = -135177.6961 PPL = 2579.9225
Combining counts.
+ srun --gres=gpu:1 theanolm train /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test/nnlm.h5 --training-set /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt --validation-file /scratch/work/moisioa3/conv_lm/data/devel/plain.txt --sequence-length 100 --batch-size 16 --optimization-method adagrad --stopping-criterion annealing-count --cost cross-entropy --learning-rate 0.1 --gradient-decay-rate 0.9 --numerical-stability-term 1e-6 --num-noise-samples 1000 --noise-dampening 0.75 --noise-sharing batch --validation-frequency 5 --patience 4 --max-epochs 15 --min-epochs 1 --random-seed 1 --log-level debug --log-interval 1000 --gradient-normalization 5 --architecture /scratch/work/moisioa3/conv_lm/configs/word+proj100+lstm300+tanh300+hsoftmax.arch --vocabulary /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test/nnlm.vocab --vocabulary-format words
Reading vocabulary from /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test/nnlm.vocab.
Computing unigram probabilities for out-of-shortlist words.
2020-06-14 13:14:33,061 compute_probs: Out-of-shortlist word log probabilities are in the range [-18.353268, -15.955372].
Number of words in vocabulary: 2427543
Number of words in shortlist: 200003
Number of word classes: 200003
2020-06-14 13:14:34,091 train: TRAINING OPTIONS
2020-06-14 13:14:34,092 train: batch_size: 16
2020-06-14 13:14:34,092 train: sequence_length: 100
2020-06-14 13:14:34,092 train: validation_frequency: 5
2020-06-14 13:14:34,092 train: patience: 4
2020-06-14 13:14:34,092 train: stopping_criterion: annealing-count
2020-06-14 13:14:34,092 train: max_epochs: 15
2020-06-14 13:14:34,092 train: min_epochs: 1
2020-06-14 13:14:34,092 train: max_annealing_count: 0
2020-06-14 13:14:34,092 train: OPTIMIZATION OPTIONS
2020-06-14 13:14:34,092 train: method: adagrad
2020-06-14 13:14:34,092 train: epsilon: 1e-06
2020-06-14 13:14:34,093 train: gradient_decay_rate: 0.9
2020-06-14 13:14:34,093 train: sqr_gradient_decay_rate: 0.999
2020-06-14 13:14:34,093 train: learning_rate: 0.1
2020-06-14 13:14:34,093 train: weights: [1. 1.]
2020-06-14 13:14:34,093 train: momentum: 0.9
2020-06-14 13:14:34,093 train: max_gradient_norm: 5.0
2020-06-14 13:14:34,093 train: num_noise_samples: 1000
2020-06-14 13:14:34,093 train: noise_sharing: batch
Creating trainer.
Computing the number of mini-batches in training data.
2020-06-14 13:17:31,290 __init__: One epoch of training data contains 547465 mini-batch updates.
2020-06-14 13:17:31,302 __init__: Class unigram log probabilities are in the range [-inf, -2.324820].
2020-06-14 13:17:31,303 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt.
2020-06-14 13:17:31,306 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt.
2020-06-14 13:17:35,714 _reset: Generating a random order of input lines.
Building neural network.
/scratch/elec/puhe/Modules/opt/Theano/Theano-f1e4ec4/lib/python3.6/site-packages/Theano-1.0.4+unknown-py3.6.egg/theano/gpuarray/dnn.py:184: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version >= v5 and <= v7.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7600 on context None
Mapped name None to device cuda0: Tesla V100-PCIE-32GB (0000:86:00.0)
Could not open one of the required files. The error message was: [Errno 2] No such file or directory: '/scratch/work/moisioa3/conv_lm/configs/word+proj100+lstm300+tanh300+hsoftmax.arch'
srun: error: gpu36: task 0: Exited with exit code 2
srun: Terminating job step 53822682.0
