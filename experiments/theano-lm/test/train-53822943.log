EXPT_NAME theano-lm
EXPT_PARAMS test
EXPT_WORK_DIR /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test
Experiment: theano-lm/test
Job ID: 53822943
Task ID: 
Host: gpu25.int.triton.aalto.fi
Start date: Sun Jun 14 13:39:50 EEST 2020
Work directory: /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test
Temporary directory: /tmp/53822943
/scratch/elec/puhe/Modules/opt/Theano/Theano-f1e4ec4/lib/python3.6/site-packages
floatX=float32,device=cuda0,base_compiledir=/tmp/theano-53822943,exception_verbosity=high
/scratch/elec/puhe/Modules/opt/Theano/Theano-f1e4ec4/lib/python3.6/site-packages/Theano-1.0.4+unknown-py3.6.egg/theano/gpuarray/dnn.py:184: UserWarning: Your cuDNN version is more recent than Theano. If you encounter problems, try updating Theano or downgrading cuDNN to a version >= v5 and <= v7.
  warnings.warn("Your cuDNN version is more recent than "
Using cuDNN version 7600 on context None
Mapped name None to device cuda0: Tesla P100-PCIE-16GB (0000:82:00.0)
TheanoLM 1.3.0
Theano 1.0.4+unknown
pygpu 0.7.6
==
+ srun --gres=gpu:1 theanolm train /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test/nnlm.h5 --training-set /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt --validation-file /scratch/work/moisioa3/conv_lm/data/devel/plain.txt --sequence-length 100 --batch-size 16 --optimization-method adagrad --stopping-criterion annealing-count --cost cross-entropy --learning-rate 0.1 --gradient-decay-rate 0.9 --numerical-stability-term 1e-6 --num-noise-samples 1000 --noise-dampening 0.75 --noise-sharing batch --validation-frequency 5 --patience 4 --max-epochs 15 --min-epochs 1 --random-seed 1 --log-level debug --log-interval 1000 --gradient-normalization 5 --architecture /scratch/work/moisioa3/conv_lm/configs/word+proj100+lstm300+tanh300+hsoftmax.arch --vocabulary /scratch/work/moisioa3/conv_lm/experiments/theano-lm/test/nnlm.vocab --vocabulary-format words
Reading vocabulary from existing network state.
2020-06-14 13:40:07,065 from_state: Out-of-shortlist word log probabilities are in the range [-18.353268, -15.955372].
Number of words in vocabulary: 2427543
Number of words in shortlist: 200003
Number of word classes: 200003
2020-06-14 13:40:07,092 train: TRAINING OPTIONS
2020-06-14 13:40:07,093 train: batch_size: 16
2020-06-14 13:40:07,093 train: sequence_length: 100
2020-06-14 13:40:07,093 train: validation_frequency: 5
2020-06-14 13:40:07,093 train: patience: 4
2020-06-14 13:40:07,093 train: stopping_criterion: annealing-count
2020-06-14 13:40:07,093 train: max_epochs: 15
2020-06-14 13:40:07,094 train: min_epochs: 1
2020-06-14 13:40:07,094 train: max_annealing_count: 0
2020-06-14 13:40:07,094 train: OPTIMIZATION OPTIONS
2020-06-14 13:40:07,094 train: method: adagrad
2020-06-14 13:40:07,094 train: epsilon: 1e-06
2020-06-14 13:40:07,094 train: gradient_decay_rate: 0.9
2020-06-14 13:40:07,094 train: sqr_gradient_decay_rate: 0.999
2020-06-14 13:40:07,094 train: learning_rate: 0.1
2020-06-14 13:40:07,095 train: weights: [1. 1.]
2020-06-14 13:40:07,095 train: momentum: 0.9
2020-06-14 13:40:07,095 train: max_gradient_norm: 5.0
2020-06-14 13:40:07,095 train: num_noise_samples: 1000
2020-06-14 13:40:07,095 train: noise_sharing: batch
Creating trainer.
Computing the number of mini-batches in training data.
2020-06-14 13:43:37,620 __init__: One epoch of training data contains 547465 mini-batch updates.
2020-06-14 13:43:37,636 __init__: Class unigram log probabilities are in the range [-inf, -2.324820].
2020-06-14 13:43:37,636 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/lm-train/dsp.txt.
2020-06-14 13:43:37,639 __init__: Finding sentence start positions in /scratch/work/moisioa3/conv_lm/data/lm-train/web.txt.
2020-06-14 13:43:42,751 _reset: Generating a random order of input lines.
Building neural network.
2020-06-14 13:43:47,268 get_default_device: Context None device="Tesla P100-PCIE-16GB" ID="0000:82:00.0"
2020-06-14 13:43:47,331 __init__: Creating layers.
2020-06-14 13:43:47,331 __init__: - NetworkInput name=word_input inputs=[] size=200003 activation=tanh devices=[]
2020-06-14 13:43:47,331 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100 activation=tanh devices=[None]
2020-06-14 13:43:48,441 add:      * layers/projection_layer/W size=20000300 type=float32 device=None
2020-06-14 13:43:48,446 __init__: - LSTMLayer name=hidden_layer_1 inputs=[projection_layer] size=300 activation=tanh devices=[None]
2020-06-14 13:43:48,469 add:      * layers/hidden_layer_1/layer_input/W size=120000 type=float32 device=None
2020-06-14 13:43:48,580 add:      * layers/hidden_layer_1/step_input/W size=360000 type=float32 device=None
2020-06-14 13:43:48,581 add:      * layers/hidden_layer_1/layer_input/b size=1200 type=float32 device=None
2020-06-14 13:43:48,581 __init__: - FullyConnectedLayer name=hidden_layer_2 inputs=[hidden_layer_1] size=300 activation=tanh devices=[None]
2020-06-14 13:43:48,626 add:      * layers/hidden_layer_2/input/W size=90000 type=float32 device=None
2020-06-14 13:43:48,627 add:      * layers/hidden_layer_2/input/b size=300 type=float32 device=None
2020-06-14 13:43:48,627 __init__: - HSoftmaxLayer name=output_layer inputs=[hidden_layer_2] size=200003 activation=tanh devices=[None]
2020-06-14 13:43:48,627 __init__:   level1_size=448 level2_size=447
2020-06-14 13:43:48,653 add:      * layers/output_layer/input/W size=134400 type=float32 device=None
2020-06-14 13:43:48,653 add:      * layers/output_layer/input/b size=448 type=float32 device=None
2020-06-14 13:43:51,859 add:      * layers/output_layer/level1/W size=60076800 type=float32 device=None
2020-06-14 13:43:51,872 add:      * layers/output_layer/level1/b size=200256 type=float32 device=None
2020-06-14 13:43:51,873 __init__: Total number of model parameters: 80983704
Building optimizer.
2020-06-14 13:43:52,348 add:      * layers/projection_layer/W_sum_sqr_gradient size=20000300 type=float32 device=None
2020-06-14 13:43:52,353 add:      * layers/hidden_layer_1/layer_input/W_sum_sqr_gradient size=120000 type=float32 device=None
2020-06-14 13:43:52,354 add:      * layers/hidden_layer_1/step_input/W_sum_sqr_gradient size=360000 type=float32 device=None
2020-06-14 13:43:52,354 add:      * layers/hidden_layer_1/layer_input/b_sum_sqr_gradient size=1200 type=float32 device=None
2020-06-14 13:43:52,355 add:      * layers/hidden_layer_2/input/W_sum_sqr_gradient size=90000 type=float32 device=None
2020-06-14 13:43:52,355 add:      * layers/hidden_layer_2/input/b_sum_sqr_gradient size=300 type=float32 device=None
2020-06-14 13:43:52,355 add:      * layers/output_layer/input/W_sum_sqr_gradient size=134400 type=float32 device=None
2020-06-14 13:43:52,356 add:      * layers/output_layer/input/b_sum_sqr_gradient size=448 type=float32 device=None
2020-06-14 13:43:52,693 add:      * layers/output_layer/level1/W_sum_sqr_gradient size=60076800 type=float32 device=None
2020-06-14 13:43:52,706 add:      * layers/output_layer/level1/b_sum_sqr_gradient size=200256 type=float32 device=None
Building text scorer for cross-validation.
Validation text: /scratch/work/moisioa3/conv_lm/data/devel/plain.txt
Training neural network.
2020-06-14 13:46:29,684 _log_update: [1000] (0.2 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 13:46:52,146 _log_update: [2000] (0.4 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 13:47:14,811 _log_update: [3000] (0.5 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 13:47:37,314 _log_update: [4000] (0.7 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:47:59,899 _log_update: [5000] (0.9 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:48:22,538 _log_update: [6000] (1.1 %) of epoch 1 -- lr = 0.1, duration = 2.7 ms
2020-06-14 13:48:44,953 _log_update: [7000] (1.3 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 13:49:07,539 _log_update: [8000] (1.5 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 13:49:29,820 _log_update: [9000] (1.6 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 13:49:52,461 _log_update: [10000] (1.8 %) of epoch 1 -- lr = 0.1, duration = 3.8 ms
2020-06-14 13:50:14,882 _log_update: [11000] (2.0 %) of epoch 1 -- lr = 0.1, duration = 2.4 ms
2020-06-14 13:50:37,648 _log_update: [12000] (2.2 %) of epoch 1 -- lr = 0.1, duration = 1.8 ms
2020-06-14 13:51:00,216 _log_update: [13000] (2.4 %) of epoch 1 -- lr = 0.1, duration = 1.8 ms
2020-06-14 13:51:22,833 _log_update: [14000] (2.6 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:51:45,347 _log_update: [15000] (2.7 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 13:52:07,766 _log_update: [16000] (2.9 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:52:30,375 _log_update: [17000] (3.1 %) of epoch 1 -- lr = 0.1, duration = 2.6 ms
2020-06-14 13:52:52,946 _log_update: [18000] (3.3 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 13:53:15,545 _log_update: [19000] (3.5 %) of epoch 1 -- lr = 0.1, duration = 2.3 ms
2020-06-14 13:53:38,309 _log_update: [20000] (3.7 %) of epoch 1 -- lr = 0.1, duration = 2.8 ms
2020-06-14 13:54:00,840 _log_update: [21000] (3.8 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:54:23,163 _log_update: [22000] (4.0 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:54:45,805 _log_update: [23000] (4.2 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 13:55:08,515 _log_update: [24000] (4.4 %) of epoch 1 -- lr = 0.1, duration = 1.7 ms
2020-06-14 13:55:31,006 _log_update: [25000] (4.6 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 13:55:53,548 _log_update: [26000] (4.7 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 13:56:16,006 _log_update: [27000] (4.9 %) of epoch 1 -- lr = 0.1, duration = 2.4 ms
2020-06-14 13:56:38,534 _log_update: [28000] (5.1 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 13:57:01,042 _log_update: [29000] (5.3 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 13:57:23,757 _log_update: [30000] (5.5 %) of epoch 1 -- lr = 0.1, duration = 3.1 ms
2020-06-14 13:57:46,523 _log_update: [31000] (5.7 %) of epoch 1 -- lr = 0.1, duration = 2.8 ms
2020-06-14 13:58:08,836 _log_update: [32000] (5.8 %) of epoch 1 -- lr = 0.1, duration = 2.6 ms
2020-06-14 13:58:31,406 _log_update: [33000] (6.0 %) of epoch 1 -- lr = 0.1, duration = 2.9 ms
2020-06-14 13:58:53,959 _log_update: [34000] (6.2 %) of epoch 1 -- lr = 0.1, duration = 2.5 ms
2020-06-14 13:59:16,251 _log_update: [35000] (6.4 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 13:59:38,775 _log_update: [36000] (6.6 %) of epoch 1 -- lr = 0.1, duration = 1.8 ms
2020-06-14 14:00:01,579 _log_update: [37000] (6.8 %) of epoch 1 -- lr = 0.1, duration = 2.3 ms
2020-06-14 14:00:24,314 _log_update: [38000] (6.9 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:00:47,140 _log_update: [39000] (7.1 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:01:09,810 _log_update: [40000] (7.3 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:01:32,434 _log_update: [41000] (7.5 %) of epoch 1 -- lr = 0.1, duration = 2.3 ms
2020-06-14 14:01:54,700 _log_update: [42000] (7.7 %) of epoch 1 -- lr = 0.1, duration = 2.4 ms
2020-06-14 14:02:17,464 _log_update: [43000] (7.9 %) of epoch 1 -- lr = 0.1, duration = 2.4 ms
2020-06-14 14:02:40,025 _log_update: [44000] (8.0 %) of epoch 1 -- lr = 0.1, duration = 1.7 ms
2020-06-14 14:03:02,419 _log_update: [45000] (8.2 %) of epoch 1 -- lr = 0.1, duration = 2.7 ms
2020-06-14 14:03:24,998 _log_update: [46000] (8.4 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 14:03:47,568 _log_update: [47000] (8.6 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 14:04:10,182 _log_update: [48000] (8.8 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:04:32,645 _log_update: [49000] (9.0 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:04:55,287 _log_update: [50000] (9.1 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:05:18,106 _log_update: [51000] (9.3 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:05:40,989 _log_update: [52000] (9.5 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:06:03,895 _log_update: [53000] (9.7 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:06:26,510 _log_update: [54000] (9.9 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 14:06:49,456 _log_update: [55000] (10.0 %) of epoch 1 -- lr = 0.1, duration = 3.1 ms
2020-06-14 14:07:12,296 _log_update: [56000] (10.2 %) of epoch 1 -- lr = 0.1, duration = 2.4 ms
2020-06-14 14:07:35,208 _log_update: [57000] (10.4 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:07:58,150 _log_update: [58000] (10.6 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 14:08:20,911 _log_update: [59000] (10.8 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:08:43,736 _log_update: [60000] (11.0 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:09:06,673 _log_update: [61000] (11.1 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:09:29,695 _log_update: [62000] (11.3 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 14:09:52,593 _log_update: [63000] (11.5 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
2020-06-14 14:10:15,638 _log_update: [64000] (11.7 %) of epoch 1 -- lr = 0.1, duration = 2.3 ms
2020-06-14 14:10:38,433 _log_update: [65000] (11.9 %) of epoch 1 -- lr = 0.1, duration = 1.9 ms
2020-06-14 14:11:01,375 _log_update: [66000] (12.1 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 14:11:23,920 _log_update: [67000] (12.2 %) of epoch 1 -- lr = 0.1, duration = 2.3 ms
2020-06-14 14:11:46,835 _log_update: [68000] (12.4 %) of epoch 1 -- lr = 0.1, duration = 1.8 ms
2020-06-14 14:12:09,730 _log_update: [69000] (12.6 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 14:12:32,501 _log_update: [70000] (12.8 %) of epoch 1 -- lr = 0.1, duration = 2.8 ms
2020-06-14 14:12:55,418 _log_update: [71000] (13.0 %) of epoch 1 -- lr = 0.1, duration = 2.2 ms
2020-06-14 14:13:18,291 _log_update: [72000] (13.2 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:13:40,954 _log_update: [73000] (13.3 %) of epoch 1 -- lr = 0.1, duration = 2.0 ms
2020-06-14 14:14:04,074 _log_update: [74000] (13.5 %) of epoch 1 -- lr = 0.1, duration = 1.8 ms
2020-06-14 14:14:26,967 _log_update: [75000] (13.7 %) of epoch 1 -- lr = 0.1, duration = 2.6 ms
2020-06-14 14:14:49,828 _log_update: [76000] (13.9 %) of epoch 1 -- lr = 0.1, duration = 2.4 ms
2020-06-14 14:15:12,623 _log_update: [77000] (14.1 %) of epoch 1 -- lr = 0.1, duration = 2.1 ms
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 53822943.0 ON gpu25 CANCELLED AT 2020-06-14T14:15:13 DUE TO TIME LIMIT ***
slurmstepd: error: *** JOB 53822943 ON gpu25 CANCELLED AT 2020-06-14T14:15:13 DUE TO TIME LIMIT ***
Job has already finished for job 53822943
