moisioa3@login2:/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain$ ./03-train.sh
EXPT_NAME kaldi-am
EXPT_PARAMS chain
EXPT_WORK_DIR /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain
./03-train.sh: creating neural net configs using the xconfig parser
tree-info /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/data/tree/tree
steps/nnet3/xconfig_to_configs.py --xconfig-file /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs/network.xconfig --config-dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs/
nnet3-init /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//init.config /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//init.raw
LOG (nnet3-init[5.5.433~1-7637d]:main():nnet3-init.cc:80) Initialized raw neural net and wrote it to /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//init.raw
nnet3-info /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//init.raw
nnet3-init /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.config /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.raw
LOG (nnet3-init[5.5.433~1-7637d]:main():nnet3-init.cc:80) Initialized raw neural net and wrote it to /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.raw
nnet3-info /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.raw
nnet3-init /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.config /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.raw
LOG (nnet3-init[5.5.433~1-7637d]:main():nnet3-init.cc:80) Initialized raw neural net and wrote it to /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.raw
nnet3-info /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/configs//ref.raw
2020-06-17 16:21:59,268 [steps/nnet3/chain/train.py:35 - <module> - INFO ] Starting chain model trainer (train.py)
steps/nnet3/chain/train.py --stage -10 --cmd /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/utils/slurm.pl --mem 3G --time 1:00:00 --feat.online-ivector-dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/ivectors/
am-train --feat.cmvn-opts --norm-means=false --norm-vars=false --chain.xent-regularize 0.1 --chain.leaky-hmm-coefficient 0.1 --chain.l2-regularize 0.0 --chain.apply-deriv-weights false --chain.lm-opts=--num-extra-lm-states=2000 --train
er.dropout-schedule 0,0@0.20,0.5@0.50,0 --trainer.add-option=--optimization.memory-compression-level=2 --egs.dir  --egs.stage -10 --egs.opts --frames-overlap-per-eg 0 --constrained false --egs.chunk-width 150,110,100 --trainer.num-chun
k-per-minibatch 64 --trainer.frames-per-iter 1500000 --trainer.num-epochs 6 --trainer.optimization.num-jobs-initial 3 --trainer.optimization.num-jobs-final 16 --trainer.optimization.initial-effective-lrate 0.00025 --trainer.optimizatio
n.final-effective-lrate 0.000025 --trainer.max-param-change 2.0 --cleanup.remove-egs false --feat-dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/mmi/data/am-train --tree-dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/
chain/data/tree --lat-dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/mmi_lats_nodup --dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain
['steps/nnet3/chain/train.py', '--stage', '-10', '--cmd', '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/utils/slurm.pl --mem 3G --time 1:00:00', '--feat.online-ivector-dir', '/scratch/work/moisioa3/conv_lm/experiments/kald
i-am/chain/ivectors/am-train', '--feat.cmvn-opts', '--norm-means=false --norm-vars=false', '--chain.xent-regularize', '0.1', '--chain.leaky-hmm-coefficient', '0.1', '--chain.l2-regularize', '0.0', '--chain.apply-deriv-weights', 'false'
, '--chain.lm-opts=--num-extra-lm-states=2000', '--trainer.dropout-schedule', '0,0@0.20,0.5@0.50,0', '--trainer.add-option=--optimization.memory-compression-level=2', '--egs.dir', '', '--egs.stage', '-10', '--egs.opts', '--frames-overl
ap-per-eg 0 --constrained false', '--egs.chunk-width', '150,110,100', '--trainer.num-chunk-per-minibatch', '64', '--trainer.frames-per-iter', '1500000', '--trainer.num-epochs', '6', '--trainer.optimization.num-jobs-initial', '3', '--tr
ainer.optimization.num-jobs-final', '16', '--trainer.optimization.initial-effective-lrate', '0.00025', '--trainer.optimization.final-effective-lrate', '0.000025', '--trainer.max-param-change', '2.0', '--cleanup.remove-egs', 'false', '-
-feat-dir', '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/mmi/data/am-train', '--tree-dir', '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/data/tree', '--lat-dir', '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am
/chain/mmi_lats_nodup', '--dir', '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain']
2020-06-17 16:21:59,325 [steps/nnet3/chain/train.py:274 - train - INFO ] Arguments for the experiment
{'alignment_subsampling_factor': 3,
 'apply_deriv_weights': False,
 'backstitch_training_interval': 1,
 'backstitch_training_scale': 0.0,
 'chunk_left_context': 0,
 'chunk_left_context_initial': -1,
 'chunk_right_context': 0,
 'chunk_right_context_final': -1,
 'chunk_width': '150,110,100',
 'cleanup': True,
 'cmvn_opts': '--norm-means=false --norm-vars=false',
 'combine_sum_to_one_penalty': 0.0,
 'command': '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/utils/slurm.pl --mem 3G --time 1:00:00',
 'compute_per_dim_accuracy': False,
 'deriv_truncate_margin': None,
 'dir': '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain',
 'do_final_combination': True,
 'dropout_schedule': '0,0@0.20,0.5@0.50,0',
 'egs_command': None,
 'egs_dir': None,
 'egs_opts': '--frames-overlap-per-eg 0 --constrained false',
 'egs_stage': -10,
 'email': None,
 'exit_stage': None,
 'feat_dir': '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/mmi/data/am-train',
 'final_effective_lrate': 2.5e-05,
 'frame_subsampling_factor': 3,
 'frames_per_iter': 1500000,
 'initial_effective_lrate': 0.00025,
 'input_model': None,
 'l2_regularize': 0.0,
 'lat_dir': '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/mmi_lats_nodup',
 'leaky_hmm_coefficient': 0.1,
 'left_deriv_truncate': None,
 'left_tolerance': 5,
 'lm_opts': '--num-extra-lm-states=2000',
 'max_lda_jobs': 10,
 'max_models_combine': 20,
 'max_objective_evaluations': 30,
 'max_param_change': 2.0,
 'momentum': 0.0,
 'num_chunk_per_minibatch': '64',
 'num_epochs': 6.0,
 'num_jobs_final': 16,
 'num_jobs_initial': 3,
 'num_jobs_step': 1,
 'online_ivector_dir': '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/ivectors/am-train',
 'preserve_model_interval': 100,
 'presoftmax_prior_scale_power': -0.25,
 'proportional_shrink': 0.0,
 'rand_prune': 4.0,
 'remove_egs': False,
 'reporting_interval': 0.1,
 'right_tolerance': 5,
 'samples_per_iter': 400000,
 'shrink_saturation_threshold': 0.4,
 'shrink_value': 1.0,
 'shuffle_buffer_size': 5000,
 'srand': 0,
 'stage': -10,
 'train_opts': ['--optimization.memory-compression-level=2'],
 'tree_dir': '/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/data/tree',
 'use_gpu': 'yes',
 'xent_regularize': 0.1}
2020-06-17 16:21:59,729 [steps/nnet3/chain/train.py:328 - train - INFO ] Creating phone language-model
2020-06-17 16:22:28,988 [steps/nnet3/chain/train.py:333 - train - INFO ] Creating denominator FST
copy-transition-model /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/data/tree/final.mdl /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/0.trans_mdl
LOG (copy-transition-model[5.5.433~1-7637d]:main():copy-transition-model.cc:62) Copied transition model.
2020-06-17 16:22:36,882 [steps/nnet3/chain/train.py:340 - train - INFO ] Initializing a basic network for estimating preconditioning matrix
2020-06-17 16:23:27,012 [steps/nnet3/chain/train.py:369 - train - INFO ] Generating egs
steps/nnet3/chain/get_egs.sh --frames-overlap-per-eg 0 --constrained false --cmd /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/utils/slurm.pl --mem 3G --time 1:00:00 --cmvn-opts --norm-means=false --norm-vars=false --online-ivector-dir /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/ivectors/am-train --left-context 35 --right-context 35 --left-context-initial -1 --right-context-final -1 --left-tolerance 5 --right-tolerance 5 --frame-subsampling-factor 3 --alignment-subsampling-factor 3 --stage -10 --frames-per-iter 1500000 --frames-per-eg 150,110,100 --srand 0 /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/mmi/data/am-train /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/mmi_lats_nodup /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/egs
utils/data/get_frame_shift.sh: /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/mmi/data/am-train/utt2dur does not exist: creating it
utils/data/get_utt2dur.sh: segments file does not exist so getting durations from wave files
utils/data/get_utt2dur.sh: could not get utterance lengths from sphere-file headers, using wav-to-duration
utils/data/get_utt2dur.sh: computed /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/mmi/data/am-train/utt2dur
steps/nnet3/chain/get_egs.sh: Holding out 300 utterances in validation set and 300 in training diagnostic set, out of total 15966.
steps/nnet3/chain/get_egs.sh: creating egs.  To ensure they are not deleted later you can do:  touch /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/egs/.nodelete
steps/nnet3/chain/get_egs.sh: feature type is raw
tree-info /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/tree   
feat-to-dim scp:/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/ivectors/am-train/ivector_online.scp -
steps/nnet3/chain/get_egs.sh: working out number of frames of training data
steps/nnet3/chain/get_egs.sh: working out feature dim
steps/nnet3/chain/get_egs.sh: creating 9 archives, each with 14643 egs, with
steps/nnet3/chain/get_egs.sh:   150,110,100 labels per example, and (left,right) context = (35,35)
steps/nnet3/chain/get_egs.sh: Getting validation and training subset examples in background.
steps/nnet3/chain/get_egs.sh: Generating training examples on disk
steps/nnet3/chain/get_egs.sh: recombining and shuffling order of archives on disk
steps/nnet3/chain/get_egs.sh: Getting subsets of validation examples for diagnostics and combination.
steps/nnet3/chain/get_egs.sh: Removing temporary archives, alignments and lattices
steps/nnet3/chain/get_egs.sh: Finished preparing training examples
2020-06-17 16:35:22,660 [steps/nnet3/chain/train.py:418 - train - INFO ] Copying the properties from /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain/egs to /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain
2020-06-17 16:35:22,684 [steps/nnet3/chain/train.py:432 - train - INFO ] Computing the preconditioning matrix for input features
2020-06-17 16:36:40,099 [steps/nnet3/chain/train.py:441 - train - INFO ] Preparing the initial acoustic model.
2020-06-17 16:38:06,998 [steps/nnet3/chain/train.py:475 - train - INFO ] Training will run for 6.0 epochs = 17 iterations
2020-06-17 16:38:06,998 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 0/16   Jobs: 3   Epoch: 0.00/6.0 (0.0% complete)   lr: 0.000750
2020-06-17 16:42:38,884 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 1/16   Jobs: 4   Epoch: 0.11/6.0 (1.9% complete)   lr: 0.000958
2020-06-17 16:47:27,675 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 2/16   Jobs: 5   Epoch: 0.26/6.0 (4.3% complete)   lr: 0.001132
2020-06-17 16:53:44,539 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 3/16   Jobs: 5   Epoch: 0.44/6.0 (7.4% complete)   lr: 0.001054
2020-06-17 17:00:09,105 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 4/16   Jobs: 6   Epoch: 0.63/6.0 (10.5% complete)   lr: 0.001178
2020-06-17 17:06:48,581 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 5/16   Jobs: 7   Epoch: 0.85/6.0 (14.2% complete)   lr: 0.001262
2020-06-17 17:13:46,941 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 6/16   Jobs: 8   Epoch: 1.11/6.0 (18.5% complete)   lr: 0.001306
2020-06-17 17:20:26,358 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 7/16   Jobs: 8   Epoch: 1.41/6.0 (23.5% complete)   lr: 0.001165
2020-06-17 17:35:47,710 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 8/16   Jobs: 9   Epoch: 1.70/6.0 (28.4% complete)   lr: 0.001170
2020-06-17 17:44:23,838 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 9/16   Jobs: 10   Epoch: 2.04/6.0 (34.0% complete)   lr: 0.001144
2020-06-17 17:51:55,342 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 10/16   Jobs: 11   Epoch: 2.41/6.0 (40.1% complete)   lr: 0.001092
2020-06-17 17:56:55,429 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 11/16   Jobs: 11   Epoch: 2.81/6.0 (46.9% complete)   lr: 0.000934
2020-06-17 18:07:17,160 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 12/16   Jobs: 12   Epoch: 3.22/6.0 (53.7% complete)   lr: 0.000871
2020-06-17 18:17:49,032 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 13/16   Jobs: 13   Epoch: 3.67/6.0 (61.1% complete)   lr: 0.000796
2020-06-17 18:28:09,974 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 14/16   Jobs: 14   Epoch: 4.15/6.0 (69.1% complete)   lr: 0.000712
2020-06-17 18:36:09,349 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 15/16   Jobs: 14   Epoch: 4.67/6.0 (77.8% complete)   lr: 0.000584
2020-06-17 18:41:13,115 [steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 16/16   Jobs: 15   Epoch: 5.19/6.0 (86.4% complete)   lr: 0.000375
2020-06-17 18:46:23,910 [steps/nnet3/chain/train.py:575 - train - INFO ] Doing final combination to produce final.mdl
2020-06-17 18:46:23,911 [steps/libs/nnet3/train/chain_objf/acoustic_model.py:571 - combine_models - INFO ] Combining set([10, 11, 12, 13, 14, 15, 16, 17]) models.
2020-06-17 18:47:31,163 [steps/nnet3/chain/train.py:604 - train - INFO ] Cleaning up the experiment directory /scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain
/scratch/work/moisioa3/conv_lm/experiments/kaldi-am/chain: num-iters=17 nj=3..15 num-params=16.2M dim=40+100->1248 combine=-0.093->-0.093 (over 1) xent:train/valid[10,16]=(-1.06,-0.953/-1.09,-1.01) logprob:train/valid[10,16]=(-0.120,-0
.098/-0.130,-0.118)